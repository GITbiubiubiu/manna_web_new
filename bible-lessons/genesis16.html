<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Genesis 16: Hagar and Ishmael - Manna</title>
  <meta name="description" content="Bible Lessons on Genesis 16 KJV: genesis 16 explained verse by verse.">
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="../css/lesson-content.css">
  <link rel="icon" href="../public/images/icon.png">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DF5ZGFNKTB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DF5ZGFNKTB');
  </script>
</head>

<body>
  <!-- Header -->
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <a href="/">
            <img src="../public/images/icon.png" alt="Manna Icon">
            <span>Manna</span>
          </a>
        </div>
        <nav>
          <ul>
            <li><a href="/bible-lessons">Lessons</a></li>
            <li><a href="/prayers">Prayers</a></li>
            <li><a href="/resources">Resources</a></li>
            <li><a href="/#download">Download</a></li>
          </ul>
        </nav>
        <div class="social-header">
          <a href="https://discord.gg/NbQVtWeNMa"><img src="../public/images/discard.png" alt="Discord"></a>
          <a href="https://www.instagram.com/the_manna_app"><img src="../public/images/ins.png" alt="Instagram"></a>
          <a href="https://www.tiktok.com/@manna.app"><img src="../public/images/tt.png" alt="TikTok"></a>
        </div>
      </div>
    </div>
  </header>

  <!-- Lesson Content -->
  <section class="lesson-content-section">
    <div class="container lesson-container">
      <!-- Left Side: Lesson Content -->
      <div class="lesson-content">
        <div class="lesson-progress">
          <div class="progress-bar">
            <div class="progress-fill" style="width: 0%"></div>
          </div>
          <div class="progress-text">0% Complete</div>
        </div>

        <!-- Section 1 -->
        <div class="lesson-section" id="section1">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>Hagar and Sarai's Conflict</h2>
              <div class="lesson-reference" data-verses="1-6">Genesis 16:1-6</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "And Sarai said unto Abram, Behold now, the LORD hath restrained me from bearing: I pray thee, go in unto my maid; it may be that I may obtain children by her. And Abram hearkened to the voice of Sarai."
                  <cite>Genesis 16:6</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>Sarai gives her servant Hagar to Abram to bear a child</li>
                  <li>Hagar becomes proud after conceiving, causing tension with Sarai</li>
                  <li>Sarai mistreats Hagar, leading Hagar to flee</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>This section begins with Sarai, Abram's wife, feeling desperate because she cannot have children. She decides to give her Egyptian servant, Hagar, to Abram so that Hagar can bear a child for them. When Hagar becomes pregnant, she starts to look down on Sarai, which causes Sarai to become upset. Sarai blames Abram for the problem, and Abram tells her to handle Hagar as she sees fit. Sarai then treats Hagar harshly, leading Hagar to run away into the wilderness. This shows how human plans can lead to conflict when not aligned with God's timing.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="next-section-btn" data-next="section2">Continue</button>
          </div>
        </div>

        <!-- Section 2 -->
        <div class="lesson-section hidden" id="section2">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>The Angel Meets Hagar in the Wilderness</h2>
              <div class="lesson-reference" data-verses="7-12">Genesis 16:7-12</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "And the angel of the LORD said unto her, Behold, thou art with child, and shalt bear a son, and shalt call his name Ishmael; because the LORD hath heard thy affliction."
                  <cite>Genesis 16:11</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>An angel finds Hagar by a spring and speaks to her</li>
                  <li>The angel tells Hagar to return and submit to Sarai</li>
                  <li>The angel promises Hagar many descendants through her son Ishmael</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>While Hagar is alone in the wilderness, an angel of the Lord finds her near a spring. The angel asks Hagar where she is going and tells her to return to Sarai and submit to her. The angel also gives Hagar a promise: her descendants will be too many to count, and her son, Ishmael, will be strong but live in conflict with others. This moment shows that God cares for those who are hurting, even when they feel forgotten. Hagar is reminded that God sees her struggles and has a plan for her future.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section1">Previous</button>
            <button class="next-section-btn" data-next="section3">Continue</button>
          </div>
        </div>

        <!-- Section 3 -->
        <div class="lesson-section hidden" id="section3">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>Hagar Names God and Returns</h2>
              <div class="lesson-reference" data-verses="13-16">Genesis 16:13-16</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "And she called the name of the LORD that spake unto her, Thou God seest me: for she said, Have I also here looked after him that seeth me?"
                  <cite>Genesis 16:13</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>Hagar calls God 'The God Who Sees' after her encounter</li>
                  <li>Hagar obeys the angel and returns to Abram and Sarai</li>
                  <li>Ishmael is born, fulfilling God's promise</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>After speaking with the angel, Hagar realizes that God has truly seen her pain. She gives God a special name, 'El Roi,' meaning 'The God Who Sees.' This is a powerful moment because it shows Hagar's personal encounter with God. She obeys the angel and returns to Abram and Sarai. Later, she gives birth to Ishmael, fulfilling part of God's promise. This teaches us that even in difficult situations, God is aware of our needs and has a purpose for our lives.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section2">Previous</button>
            <button class="next-section-btn" data-next="quiz">Test My Mastery</button>
          </div>
        </div>

        <!-- Quiz Section -->
        <div class="lesson-section hidden" id="quiz">
          <div class="lesson-card quiz-card">
            <div class="lesson-card-header">
              <h2>Level Up Test</h2>
              <div class="lesson-reference" data-verses="1-16">Genesis 16</div>
            </div>
            <div class="lesson-card-body">
              <div class="quiz-container">
                <div class="quiz-progress">
                  <span id="quiz-progress-text">Question 1 of 3</span>
                  <div class="quiz-progress-bar">
                    <div class="quiz-progress-fill" style="width: 33%"></div>
                  </div>
                </div>
                
                <form id="quiz-form">
                  <!-- Question 1 -->
                  <div class="quiz-question" id="question1">
                    <h3>1. Why did Sarai give Hagar to Abram?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q1a" name="q1" value="A">
                        <label for="q1a">A. To help with household chores</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1b" name="q1" value="B">
                        <label for="q1b">B. To bear a child for them</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1c" name="q1" value="C">
                        <label for="q1c">C. To send her away permanently</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1d" name="q1" value="D">
                        <label for="q1d">D. To teach her a lesson</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 16:2</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="submit-question-btn" data-question="1" data-verses="2">Submit Answer</button>
                      </div>
                    </div>
                  </div>

                  <!-- Question 2 -->
                  <div class="quiz-question hidden" id="question2">
                    <h3>2. What did the angel promise Hagar about her son?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q2a" name="q2" value="A">
                        <label for="q2a">A. He would be a great king</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2b" name="q2" value="B">
                        <label for="q2b">B. He would live in peace with everyone</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2c" name="q2" value="C">
                        <label for="q2c">C. His descendants would be too many to count</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2d" name="q2" value="D">
                        <label for="q2d">D. He would never face hardship</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 16:10</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="prev-question-btn" data-prev="1">Previous</button>
                        <button type="button" class="submit-question-btn" data-question="2" data-verses="10">Submit Answer</button>
                      </div>
                    </div>
                  </div>

                  <!-- Question 3 -->
                  <div class="quiz-question hidden" id="question3">
                    <h3>3. What name did Hagar give to God after their encounter?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q3a" name="q3" value="A">
                        <label for="q3a">A. The Almighty</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3b" name="q3" value="B">
                        <label for="q3b">B. The God Who Sees</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3c" name="q3" value="C">
                        <label for="q3c">C. The Lord of Hosts</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3d" name="q3" value="D">
                        <label for="q3d">D. The Everlasting Father</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 16:13</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="prev-question-btn" data-prev="2">Previous</button>
                        <button type="button" class="submit-question-btn" data-question="3" data-verses="13">Submit Answer</button>
                      </div>
                    </div>
                  </div>
                </form>

                <div id="quiz-results" class="hidden">
                  <h3>Your Results</h3>
                  <p id="quiz-score"></p>
                  <div id="quiz-feedback"></div>
                  <div class="quiz-result-buttons">
                    <button id="retry-quiz-btn">Try Again</button>
                    <button id="complete-lesson-btn">Complete Lesson</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section3">Previous</button>
          </div>
        </div>

        <!-- Completion Message (Hidden initially) -->
        <div class="lesson-completion hidden" id="completion">
          <div class="completion-card">
            <div class="completion-header">
              <div class="completion-icon">âœ“</div>
              <h2>Lesson Complete!</h2>
            </div>
            <div class="completion-content">
              <p class="completion-message">Congratulations on completing Genesis 16. You've learned about Hagar, Ishmael, and how God sees and cares for everyone.</p>
              
              <div class="app-promotion">
                <p class="app-promotion-text">Download the Manna App to unlock more free content.</p>
                <ul class="app-features-list">
                  <li>More audio courses, Prayer, and Devotional content for Free</li>
                  <li>Progress tracking, streak rewards, and grow closer to God</li>
                  <li>Get answers to any Bible-related questions</li>
                </ul>
                <div class="download-options">
                  <div class="qr-code">
                    <img src="../public/images/qrcode.png" alt="QR Code to download Manna App">
                  </div>
                  <div class="app-store-links">
                    <a href="https://apps.apple.com/us/app/manna-bible-study-prayer/id1669523799" class="app-store-link">
                      <img src="../public/images/download.png" alt="Download on App Store">
                    </a>
                  </div>
                </div>
              </div>
              
              <div class="completion-buttons">
                <a href="/bible-lessons/genesis17" class="lesson-btn primary-btn">Next Lesson: Genesis 17</a>
                <a href="/bible-lessons" class="lesson-btn secondary-btn">Back to Lessons</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Side: Bible Text -->
      <div class="bible-text">
        <div class="bible-header">
          <h2>Genesis 16</h2>
          <div class="bible-controls">
            <button id="increase-font">A+</button>
            <button id="decrease-font">A-</button>
          </div>
        </div>
        <div class="bible-content">
          <p><sup>1</sup> Now Sarai Abram's wife bare him no children: and she had an handmaid, an Egyptian, whose name was Hagar.</p>
          <p><sup>2</sup> And Sarai said unto Abram, Behold now, the LORD hath restrained me from bearing: I pray thee, go in unto my maid; it may be that I may obtain children by her. And Abram hearkened to the voice of Sarai.</p>
          <p><sup>3</sup> And Sarai Abram's wife took Hagar her maid the Egyptian, after Abram had dwelt ten years in the land of Canaan, and gave her to her husband Abram to be his wife.</p>
          <p><sup>4</sup> And he went in unto Hagar, and she conceived: and when she saw that she had conceived, her mistress was despised in her eyes.</p>
          <p><sup>5</sup> And Sarai said unto Abram, My wrong be upon thee: I have given my maid into thy bosom; and when she saw that she had conceived, I was despised in her eyes: the LORD judge between me and thee.</p>
          <p><sup>6</sup> But Abram said unto Sarai, Behold, thy maid is in thy hand; do to her as it pleaseth thee. And when Sarai dealt hardly with her, she fled from her face.</p>
          <p><sup>7</sup> And the angel of the LORD found her by a fountain of water in the wilderness, by the fountain in the way to Shur.</p>
          <p><sup>8</sup> And he said, Hagar, Sarai's maid, whence camest thou? and whither wilt thou go? And she said, I flee from the face of my mistress Sarai.</p>
          <p><sup>9</sup> And the angel of the LORD said unto her, Return to thy mistress, and submit thyself under her hands.</p>
          <p><sup>10</sup> And the angel of the LORD said unto her, I will multiply thy seed exceedingly, that it shall not be numbered for multitude.</p>
          <p><sup>11</sup> And the angel of the LORD said unto her, Behold, thou art with child, and shalt bear a son, and shalt call his name Ishmael; because the LORD hath heard thy affliction.</p>
          <p><sup>12</sup> And he will be a wild man; his hand will be against every man, and every man's hand against him; and he shall dwell in the presence of all his brethren.</p>
          <p><sup>13</sup> And she called the name of the LORD that spake unto her, Thou God seest me: for she said, Have I also here looked after him that seeth me?</p>
          <p><sup>14</sup> Wherefore the well was called Beerlahairoi; behold, it is between Kadesh and Bered.</p>
          <p><sup>15</sup> And Hagar bare Abram a son: and Abram called his son's name, which Hagar bare, Ishmael.</p>
          <p><sup>16</sup> And Abram was fourscore and six years old, when Hagar bare Ishmael to Abram.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-column">
          <h4>Links</h4>
          <div class="social-links">
            <a href="https://discord.gg/NbQVtWeNMa"><img src="../public/images/discard.png" alt="Discord"></a>
            <a href="https://www.instagram.com/the_manna_app"><img src="../public/images/ins.png" alt="Instagram"></a>
            <a href="https://www.tiktok.com/@manna.app"><img src="../public/images/tt.png" alt="TikTok"></a>
          </div>
        </div>
        <div class="footer-column">
          <h4>Contact Us</h4>
          <p><a href="mailto:support@themanna.app">support@themanna.app</a></p>
        </div>
        <div class="footer-column">
          <h4>Legal</h4>
          <div class="legal">
            <a href="https://s.femometer.com/html_template/3027.html">Privacy Policy</a>
            <a href="https://s.femometer.com/html_template/3028.html">Terms of Service</a>
          </div>
        </div>
      </div>
      <div class="copyright">
        <p>&copy; 2025 Baymed Limited. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Navigation between sections
      const sections = document.querySelectorAll('.lesson-section');
      const progressBar = document.querySelector('.progress-fill');
      const progressText = document.querySelector('.progress-text');
      const bibleVerses = document.querySelectorAll('.bible-content p');
      let currentSectionIndex = 0;
      const totalSections = sections.length - 1; // Excluding quiz section
      
      // Highlight and scroll to the specified scripture
      function highlightVerses(verseRange) {
        // Remove previous highlighting
        bibleVerses.forEach(verse => {
          verse.classList.remove('highlighted');
        });
        
        if (verseRange) {
          const [start, end] = verseRange.split('-').map(v => parseInt(v));
          const endVerse = end || start;
          
          // Add highlighting to the referenced scripture
          for (let i = start - 1; i < endVerse; i++) {
            if (bibleVerses[i]) {
              bibleVerses[i].classList.add('highlighted');
              
              // Scroll to the first highlighted scripture
              if (i === start - 1) {
                bibleVerses[i].scrollIntoView({
                  behavior: 'smooth',
                  block: 'center'
                });
              }
            }
          }
        }
      }
      
      // Update progress
      function updateProgress() {
        if (currentSectionIndex < totalSections) {
          const progress = Math.round((currentSectionIndex / totalSections) * 100);
          progressBar.style.width = `${progress}%`;
          progressText.textContent = `${progress}% Complete`;
        }
      }
      
      // Show section
      function showSection(sectionId) {
        sections.forEach(section => {
          section.classList.add('hidden');
        });
        
        const currentSection = document.getElementById(sectionId);
        currentSection.classList.remove('hidden');
        
        // Update current section index
        for (let i = 0; i < sections.length; i++) {
          if (sections[i].id === sectionId) {
            currentSectionIndex = i;
            break;
          }
        }
        
        // Automatically highlight relevant scriptures
        const reference = currentSection.querySelector('.lesson-reference');
        if (reference) {
          const verseRange = reference.getAttribute('data-verses');
          highlightVerses(verseRange);
        }
        
        updateProgress();

        // If this is the quiz module, immediately hide all Previous buttons
        if (sectionId === 'quiz') {
          // Hide Previous button in bottom navigation
          document.querySelector('#quiz .lesson-navigation-buttons .prev-section-btn').style.display = 'none';
          // Hide Previous button in all questions
          document.querySelectorAll('.prev-question-btn').forEach(button => {
            button.style.display = 'none';
          });
        }
        
        // Scroll to section top
        window.scrollTo({
          top: document.querySelector('.lesson-content').offsetTop - 100,
          behavior: 'smooth'
        });
      }
      
      // Next section buttons
      document.querySelectorAll('.next-section-btn').forEach(button => {
        button.addEventListener('click', function() {
          const nextSectionId = this.getAttribute('data-next');
          showSection(nextSectionId);
        });
      });
      
      // Previous section buttons
      document.querySelectorAll('.prev-section-btn').forEach(button => {
        button.addEventListener('click', function() {
          const prevSectionId = this.getAttribute('data-prev');
          showSection(prevSectionId);
        });
      });
      
      // Initialize scripture highlighting for the first section
      const initialReference = document.querySelector('#section1 .lesson-reference');
      if (initialReference) {
        const verseRange = initialReference.getAttribute('data-verses');
        highlightVerses(verseRange);
      }
      
      // Quiz functionality
      const quizForm = document.getElementById('quiz-form');
      const quizQuestions = document.querySelectorAll('.quiz-question');
      const quizResults = document.getElementById('quiz-results');
      const quizScore = document.getElementById('quiz-score');
      const quizFeedback = document.getElementById('quiz-feedback');
      const retryQuizBtn = document.getElementById('retry-quiz-btn');
      const completeLessonBtn = document.getElementById('complete-lesson-btn');
      const quizProgressText = document.getElementById('quiz-progress-text');
      const quizProgressFill = document.querySelector('.quiz-progress-fill');
      const bibleTextSection = document.querySelector('.bible-text');
      let currentQuestionIndex = 0;
      let userAnswers = {};
      let questionSubmitted = {};

      // Hide Bible text on initialization
      function toggleBibleText(show) {
        if (show) {
          bibleTextSection.style.display = 'block';
        } else {
          bibleTextSection.style.display = 'none';
        }
      }

      // Show specified question
      function showQuestion(index) {
        quizQuestions.forEach((question, i) => {
          if (i === index) {
            question.classList.remove('hidden');
          } else {
            question.classList.add('hidden');
          }
        });
        
        // Update progress bar
        currentQuestionIndex = index;
        quizProgressText.textContent = `Question ${index + 1} of ${quizQuestions.length}`;
        quizProgressFill.style.width = `${((index + 1) / quizQuestions.length) * 100}%`;
        
        // If question is submitted, show Bible text, otherwise hide it
        toggleBibleText(questionSubmitted[index + 1]);
      }

      // Submit question answer
      function submitQuestion(questionNumber, verseRange) {
        const questionIndex = questionNumber - 1;
        const selectedOption = document.querySelector(`input[name="q${questionNumber}"]:checked`);
        const feedbackElement = document.querySelector(`#question${questionNumber} .quiz-feedback`);
        const hintElement = document.querySelector(`#question${questionNumber} .quiz-hint`);
        const submitButton = document.querySelector(`#question${questionNumber} .submit-question-btn`);
        const nextButton = document.createElement('button');
        nextButton.type = 'button';
        nextButton.className = 'next-question-btn';
        
        const answers = {
          q1: 'B',
          q2: 'C',
          q3: 'B'
        };
        
        if (!selectedOption) {
          feedbackElement.innerHTML = '<p class="incorrect">Please select an answer.</p>';
          feedbackElement.classList.remove('hidden');
          return;
        }
        
        // Record user answer
        userAnswers[`q${questionNumber}`] = selectedOption.value;
        questionSubmitted[questionNumber] = true;
        
        // Show hint and feedback
        hintElement.classList.remove('hidden');
        
        // Disable options and submit button
        document.querySelectorAll(`#question${questionNumber} input[type="radio"]`).forEach(input => {
          input.disabled = true;
        });
        submitButton.disabled = true;
        submitButton.style.display = 'none'; // Hide submit button
        
        // Show feedback
        if (selectedOption.value === answers[`q${questionNumber}`]) {
          feedbackElement.innerHTML = '<p class="correct">Correct!</p>';
        } else {
          feedbackElement.innerHTML = `<p class="incorrect">Incorrect. The correct answer is ${answers[`q${questionNumber}`]}.</p>`;
        }
        feedbackElement.classList.remove('hidden');
        
        // Show Bible text and highlight relevant verses
        toggleBibleText(true);
        highlightVerses(verseRange);
        
        // If not the last question, add next question button
        if (questionNumber < quizQuestions.length) {
          nextButton.textContent = 'Next Question';
          nextButton.setAttribute('data-next', questionNumber + 1);
          nextButton.addEventListener('click', function() {
            showQuestion(parseInt(this.getAttribute('data-next')) - 1);
          });
          submitButton.parentNode.appendChild(nextButton);
        } else {
          // If last question, add view results button
          nextButton.textContent = 'View Results';
          nextButton.addEventListener('click', showResults);
          submitButton.parentNode.appendChild(nextButton);
        }
      }

      // Show quiz results
      function showResults() {
        const answers = {
          q1: 'B',
          q2: 'C',
          q3: 'B'
        };
        
        let score = 0;
        let feedback = '';
        
        // Check answers
        for (const question in answers) {
          if (userAnswers[question] === answers[question]) {
            score++;
            feedback += `<p class="correct">Question ${question.substring(1)}: Correct!</p>`;
          } else {
            feedback += `<p class="incorrect">Question ${question.substring(1)}: Incorrect. The correct answer is ${answers[question]}.</p>`;
          }
        }
        
        // Show results
        quizScore.textContent = `You scored ${score} out of 3`;
        quizFeedback.innerHTML = feedback;
        
        // Hide questions, show results
        quizQuestions.forEach(question => {
          question.classList.add('hidden');
        });
        quizResults.classList.remove('hidden');
      }

      // Reset quiz
      retryQuizBtn.addEventListener('click', function() {
        quizForm.reset();
        quizResults.classList.add('hidden');
        userAnswers = {};
        questionSubmitted = {};
        
        // Reset all question states
        document.querySelectorAll('.quiz-hint').forEach(element => {
          element.classList.add('hidden');
        });
        
        document.querySelectorAll('.quiz-feedback').forEach(element => {
          element.classList.add('hidden');
          element.innerHTML = ''; // Clear feedback content
        });
        
        document.querySelectorAll('.quiz-question input[type="radio"]').forEach(input => {
          input.disabled = false;
        });
        
        document.querySelectorAll('.submit-question-btn').forEach(button => {
          button.disabled = false;
          button.style.display = '';
        });
        
        document.querySelectorAll('.next-question-btn').forEach(button => {
          button.remove();
        });
        
        // Show first question
        showQuestion(0);
        toggleBibleText(false);
      });

      // Complete lesson
      completeLessonBtn.addEventListener('click', function() {
        document.getElementById('quiz').classList.add('hidden');
        document.getElementById('completion').classList.remove('hidden');
        progressBar.style.width = '100%';
        progressText.textContent = '100% Complete';
        // Hide Bible text
        toggleBibleText(false);
      });

      // Previous question button
      document.querySelectorAll('.prev-question-btn').forEach(button => {
        button.addEventListener('click', function() {
          const prevQuestionIndex = parseInt(this.getAttribute('data-prev')) - 1;
          showQuestion(prevQuestionIndex);
        });
      });

      // Submit answer button
      document.querySelectorAll('.submit-question-btn').forEach(button => {
        button.addEventListener('click', function() {
          const questionNumber = parseInt(this.getAttribute('data-question'));
          const verseRange = this.getAttribute('data-verses');
          submitQuestion(questionNumber, verseRange);
        });
      });

      // Initialize quiz
      function initQuiz() {
        // Ensure only the first question is displayed, hide others
        quizQuestions.forEach((question, i) => {
          if (i === 0) {
            question.classList.remove('hidden');
          } else {
            question.classList.add('hidden');
          }
        });
        
        // Hide all hints
        document.querySelectorAll('.quiz-hint').forEach(hint => {
          hint.classList.add('hidden');
        });
        
        // Hide results section
        document.getElementById('quiz-results').classList.add('hidden');
        
        // Hide Previous button in bottom navigation
        document.querySelector('#quiz .lesson-navigation-buttons .prev-section-btn').style.display = 'none';
        
        // Hide Previous button in all questions
        document.querySelectorAll('.prev-question-btn').forEach(button => {
          button.style.display = 'none';
        });
        
        toggleBibleText(false);
      }

      // Initialize when entering quiz section
      document.querySelector('[data-next="quiz"]').addEventListener('click', function() {
        setTimeout(initQuiz, 100); // Give DOM update a little time
      });
      
      // Bible text font size controls
      const bibleContent = document.querySelector('.bible-content');
      let fontSize = 16; // Default font size
      
      document.getElementById('increase-font').addEventListener('click', function() {
        if (fontSize < 24) {
          fontSize += 2;
          bibleContent.style.fontSize = `${fontSize}px`;
        }
      });
      
      document.getElementById('decrease-font').addEventListener('click', function() {
        if (fontSize > 12) {
          fontSize -= 2;
          bibleContent.style.fontSize = `${fontSize}px`;
        }
      });
    });
  </script>
</body>
</html>
