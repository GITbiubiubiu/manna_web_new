<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Genesis 15: God's Covenant with Abram - Manna</title>
  <meta name="description" content="Bible Lessons on Genesis 15 KJV: genesis 15 explained verse by verse.">
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="../css/lesson-content.css">
  <link rel="icon" href="../public/images/icon.png">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DF5ZGFNKTB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DF5ZGFNKTB');
  </script>
</head>

<body>
  <!-- Header -->
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <a href="/">
            <img src="../public/images/icon.png" alt="Manna Icon">
            <span>Manna</span>
          </a>
        </div>
        <nav>
          <ul>
            <li><a href="/bible-lessons">Lessons</a></li>
            <li><a href="/prayers">Prayers</a></li>
            <li><a href="/resources">Resources</a></li>
            <li><a href="/download">Download</a></li>
          </ul>
        </nav>
        <div class="social-header">
          <a href="https://discord.gg/NbQVtWeNMa"><img src="../public/images/discard.png" alt="Discord"></a>
          <a href="https://www.instagram.com/the_manna_app"><img src="../public/images/ins.png" alt="Instagram"></a>
          <a href="https://www.tiktok.com/@manna.app"><img src="../public/images/tt.png" alt="TikTok"></a>
        </div>
      </div>
    </div>
  </header>

  <!-- Lesson Content -->
  <section class="lesson-content-section">
    <div class="container lesson-container">
      <!-- Left Side: Lesson Content -->
      <div class="lesson-content">
        <div class="lesson-progress">
          <div class="progress-bar">
            <div class="progress-fill" style="width: 0%"></div>
          </div>
          <div class="progress-text">0% Complete</div>
        </div>

        <!-- Section 1 -->
        <div class="lesson-section" id="section1">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>God's Promise to Abram</h2>
              <div class="lesson-reference" data-verses="1-6">Genesis 15:1-6</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "And he believed in the LORD; and he counted it to him for righteousness."
                  <cite>Genesis 15:6</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>God reassures Abram of His protection and great reward</li>
                  <li>Abram expresses concern about lacking an heir</li>
                  <li>God promises Abram descendants as numerous as the stars</li>
                  <li>Abram believes God, and his faith is counted as righteousness</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>In this section, God speaks to Abram in a vision, comforting him with promises of protection and a great reward. Abram, however, is troubled because he has no children to inherit his blessings. God responds by taking Abram outside and telling him to count the stars—his descendants will be as countless as them. Abram trusts God completely, and this faith pleases God, showing that belief is more important than anything else. This moment highlights how trust in God's promises brings favor.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="next-section-btn" data-next="section2">Continue</button>
          </div>
        </div>

        <!-- Section 2 -->
        <div class="lesson-section hidden" id="section2">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>The Covenant Ceremony</h2>
              <div class="lesson-reference" data-verses="7-11">Genesis 15:7-11</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "And he said unto him, I am the LORD that brought thee out of Ur of the Chaldees, to give thee this land to inherit it."
                  <cite>Genesis 15:7</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>God reminds Abram of His promise to give him the land</li>
                  <li>Abram asks for a sign to confirm God's promise</li>
                  <li>God instructs Abram to prepare a sacrifice</li>
                  <li>Abram obeys, and birds of prey try to disturb the sacrifice</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>Here, God reminds Abram that He brought him out of his homeland to give him a new one. Abram asks for assurance, and God tells him to prepare animals for a covenant ceremony. Abram cuts the animals in half, arranging them as was customary in ancient agreements. When birds try to interfere, Abram drives them away, showing his commitment to the process. This act sets the stage for God's formal promise, demonstrating that covenants require preparation and faithfulness.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section1">Previous</button>
            <button class="next-section-btn" data-next="section3">Continue</button>
          </div>
        </div>

        <!-- Section 3 -->
        <div class="lesson-section hidden" id="section3">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>Prophecy of Future Suffering and Deliverance</h2>
              <div class="lesson-reference" data-verses="12-21">Genesis 15:12-21</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "And he said unto Abram, Know of a surety that thy seed shall be a stranger in a land that is not theirs, and shall serve them; and they shall afflict them four hundred years."
                  <cite>Genesis 15:13</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>God reveals Abram's descendants will face slavery but later be freed</li>
                  <li>A deep sleep and darkness fall upon Abram</li>
                  <li>God specifies the boundaries of the land He will give</li>
                  <li>A smoking firepot and flaming torch symbolize God's covenant</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>As the sun sets, Abram falls into a deep sleep, and God reveals the future of his descendants. They will suffer as slaves in a foreign land but will later return with great wealth. God then describes the land Abram's family will inherit, from Egypt to the Euphrates River. A smoking firepot and flaming torch pass between the animal pieces, symbolizing God's unbreakable promise. This vision assures Abram that, despite hardships, God's plan will prevail.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section2">Previous</button>
            <button class="next-section-btn" data-next="quiz">Test My Mastery</button>
          </div>
        </div>

        <!-- Quiz Section -->
        <div class="lesson-section hidden" id="quiz">
          <div class="lesson-card quiz-card">
            <div class="lesson-card-header">
              <h2>Level Up Test</h2>
              <div class="lesson-reference" data-verses="1-21">Genesis 15</div>
            </div>
            <div class="lesson-card-body">
              <div class="quiz-container">
                <div class="quiz-progress">
                  <span id="quiz-progress-text">Question 1 of 3</span>
                  <div class="quiz-progress-bar">
                    <div class="quiz-progress-fill" style="width: 33%"></div>
                  </div>
                </div>
                
                <form id="quiz-form">
                  <!-- Question 1 -->
                  <div class="quiz-question" id="question1">
                    <h3>1. What did God compare Abram's descendants to?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q1a" name="q1" value="A">
                        <label for="q1a">A. Grains of sand</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1b" name="q1" value="B">
                        <label for="q1b">B. Stars in the sky</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1c" name="q1" value="C">
                        <label for="q1c">C. Leaves on a tree</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1d" name="q1" value="D">
                        <label for="q1d">D. Drops in the ocean</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 15:5</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="submit-question-btn" data-question="1" data-verses="5">Submit Answer</button>
                      </div>
                    </div>
                  </div>

                  <!-- Question 2 -->
                  <div class="quiz-question hidden" id="question2">
                    <h3>2. What did Abram do when birds tried to disturb the sacrifice?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q2a" name="q2" value="A">
                        <label for="q2a">A. Ignored them</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2b" name="q2" value="B">
                        <label for="q2b">B. Offered them as part of the sacrifice</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2c" name="q2" value="C">
                        <label for="q2c">C. Drove them away</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2d" name="q2" value="D">
                        <label for="q2d">D. Prayed for them to leave</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 15:11</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="prev-question-btn" data-prev="1">Previous</button>
                        <button type="button" class="submit-question-btn" data-question="2" data-verses="11">Submit Answer</button>
                      </div>
                    </div>
                  </div>

                  <!-- Question 3 -->
                  <div class="quiz-question hidden" id="question3">
                    <h3>3. What did God say would happen to Abram's descendants before their deliverance?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q3a" name="q3" value="A">
                        <label for="q3a">A. They would become kings</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3b" name="q3" value="B">
                        <label for="q3b">B. They would suffer slavery</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3c" name="q3" value="C">
                        <label for="q3c">C. They would wander the desert</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3d" name="q3" value="D">
                        <label for="q3d">D. They would build a great city</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 15:13</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="prev-question-btn" data-prev="2">Previous</button>
                        <button type="button" class="submit-question-btn" data-question="3" data-verses="13">Submit Answer</button>
                      </div>
                    </div>
                  </div>
                </form>

                <div id="quiz-results" class="hidden">
                  <h3>Your Results</h3>
                  <p id="quiz-score"></p>
                  <div id="quiz-feedback"></div>
                  <div class="quiz-result-buttons">
                    <button id="retry-quiz-btn">Try Again</button>
                    <button id="complete-lesson-btn">Complete Lesson</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section3">Previous</button>
          </div>
        </div>

        <!-- Completion Message (Hidden initially) -->
        <div class="lesson-completion hidden" id="completion">
          <div class="completion-card">
            <div class="completion-header">
              <div class="completion-icon">✓</div>
              <h2>Lesson Complete!</h2>
            </div>
            <div class="completion-content">
              <p class="completion-message">Congratulations on completing Genesis 15. You've learned about God's covenant with Abram and His promises for the future.</p>
              
              <div class="app-promotion">
                <p class="app-promotion-text">Download the Manna App to unlock more free content.</p>
                <ul class="app-features-list">
                  <li>More audio courses, Prayer, and Devotional content for Free</li>
                  <li>Progress tracking, streak rewards, and grow closer to God</li>
                  <li>Get answers to any Bible-related questions</li>
                </ul>
                <a href="/download" class="cta-btn">Download Manna Today</a>
              </div>
              
              <div class="completion-buttons">
                <a href="/bible-lessons/genesis16" class="lesson-btn primary-btn">Next Lesson: Genesis 16</a>
                <a href="/bible-lessons" class="lesson-btn secondary-btn">Back to Lessons</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Side: Bible Text -->
      <div class="bible-text">
        <div class="bible-header">
          <h2>Genesis 15</h2>
          <div class="bible-controls">
            <button id="increase-font">A+</button>
            <button id="decrease-font">A-</button>
          </div>
        </div>
        <div class="bible-content">
          <p><sup>1</sup> After these things the word of the LORD came unto Abram in a vision, saying, Fear not, Abram: I am thy shield, and thy exceeding great reward.</p>
          <p><sup>2</sup> And Abram said, Lord GOD, what wilt thou give me, seeing I go childless, and the steward of my house is this Eliezer of Damascus?</p>
          <p><sup>3</sup> And Abram said, Behold, to me thou hast given no seed: and, lo, one born in my house is mine heir.</p>
          <p><sup>4</sup> And, behold, the word of the LORD came unto him, saying, This shall not be thine heir; but he that shall come forth out of thine own bowels shall be thine heir.</p>
          <p><sup>5</sup> And he brought him forth abroad, and said, Look now toward heaven, and tell the stars, if thou be able to number them: and he said unto him, So shall thy seed be.</p>
          <p><sup>6</sup> And he believed in the LORD; and he counted it to him for righteousness.</p>
          <p><sup>7</sup> And he said unto him, I am the LORD that brought thee out of Ur of the Chaldees, to give thee this land to inherit it.</p>
          <p><sup>8</sup> And he said, Lord GOD, whereby shall I know that I shall inherit it?</p>
          <p><sup>9</sup> And he said unto him, Take me an heifer of three years old, and a she goat of three years old, and a ram of three years old, and a turtledove, and a young pigeon.</p>
          <p><sup>10</sup> And he took unto him all these, and divided them in the midst, and laid each piece one against another: but the birds divided he not.</p>
          <p><sup>11</sup> And when the fowls came down upon the carcases, Abram drove them away.</p>
          <p><sup>12</sup> And when the sun was going down, a deep sleep fell upon Abram; and, lo, an horror of great darkness fell upon him.</p>
          <p><sup>13</sup> And he said unto Abram, Know of a surety that thy seed shall be a stranger in a land that is not theirs, and shall serve them; and they shall afflict them four hundred years;</p>
          <p><sup>14</sup> And also that nation, whom they shall serve, will I judge: and afterward shall they come out with great substance.</p>
          <p><sup>15</sup> And thou shalt go to thy fathers in peace; thou shalt be buried in a good old age.</p>
          <p><sup>16</sup> But in the fourth generation they shall come hither again: for the iniquity of the Amorites is not yet full.</p>
          <p><sup>17</sup> And it came to pass, that, when the sun went down, and it was dark, behold a smoking furnace, and a burning lamp that passed between those pieces.</p>
          <p><sup>18</sup> In the same day the LORD made a covenant with Abram, saying, Unto thy seed have I given this land, from the river of Egypt unto the great river, the river Euphrates:</p>
          <p><sup>19</sup> The Kenites, and the Kenizzites, and the Kadmonites,</p>
          <p><sup>20</sup> And the Hittites, and the Perizzites, and the Rephaims,</p>
          <p><sup>21</sup> And the Amorites, and the Canaanites, and the Girgashites, and the Jebusites.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-column">
          <h4>Links</h4>
          <div class="social-links">
            <a href="https://discord.gg/NbQVtWeNMa"><img src="../public/images/discard.png" alt="Discord"></a>
            <a href="https://www.instagram.com/the_manna_app"><img src="../public/images/ins.png" alt="Instagram"></a>
            <a href="https://www.tiktok.com/@manna.app"><img src="../public/images/tt.png" alt="TikTok"></a>
          </div>
        </div>
        <div class="footer-column">
          <h4>Contact Us</h4>
          <p><a href="mailto:support@themanna.app">support@themanna.app</a></p>
        </div>
        <div class="footer-column">
          <h4>Legal</h4>
          <div class="legal">
            <a href="https://s.femometer.com/html_template/3027.html">Privacy Policy</a>
            <a href="https://s.femometer.com/html_template/3028.html">Terms of Service</a>
          </div>
        </div>
      </div>
      <div class="copyright">
        <p>&copy; 2025 Baymed Limited. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Navigation between sections
      const sections = document.querySelectorAll('.lesson-section');
      const progressBar = document.querySelector('.progress-fill');
      const progressText = document.querySelector('.progress-text');
      const bibleVerses = document.querySelectorAll('.bible-content p');
      let currentSectionIndex = 0;
      const totalSections = sections.length - 1; // Excluding quiz section
      
      // 高亮并滚动到指定的经文
      function highlightVerses(verseRange) {
        // 移除之前的高亮
        bibleVerses.forEach(verse => {
          verse.classList.remove('highlighted');
        });
        
        if (verseRange) {
          const [start, end] = verseRange.split('-').map(v => parseInt(v));
          const endVerse = end || start;
          
          // 添加高亮到引用的经文
          for (let i = start - 1; i < endVerse; i++) {
            if (bibleVerses[i]) {
              bibleVerses[i].classList.add('highlighted');
              
              // 滚动到第一个高亮的经文
              if (i === start - 1) {
                bibleVerses[i].scrollIntoView({
                  behavior: 'smooth',
                  block: 'center'
                });
              }
            }
          }
        }
      }
      
      // Update progress
      function updateProgress() {
        if (currentSectionIndex < totalSections) {
          const progress = Math.round((currentSectionIndex / totalSections) * 100);
          progressBar.style.width = `${progress}%`;
          progressText.textContent = `${progress}% Complete`;
        }
      }
      
      // Show section
      function showSection(sectionId) {
        sections.forEach(section => {
          section.classList.add('hidden');
        });
        
        const currentSection = document.getElementById(sectionId);
        currentSection.classList.remove('hidden');
        
        // 更新当前部分索引
        for (let i = 0; i < sections.length; i++) {
          if (sections[i].id === sectionId) {
            currentSectionIndex = i;
            break;
          }
        }
        
        // 自动高亮相关经文
        const reference = currentSection.querySelector('.lesson-reference');
        if (reference) {
          const verseRange = reference.getAttribute('data-verses');
          highlightVerses(verseRange);
        }
        
        updateProgress();

        // 如果是测试模块，立即隐藏所有 Previous 按钮
        if (sectionId === 'quiz') {
          // 隐藏底部导航中的 Previous 按钮
          document.querySelector('#quiz .lesson-navigation-buttons .prev-section-btn').style.display = 'none';
          // 隐藏问题中的 Previous 按钮
          document.querySelectorAll('.prev-question-btn').forEach(button => {
            button.style.display = 'none';
          });
        }
        
        // 滚动到部分顶部
        window.scrollTo({
          top: document.querySelector('.lesson-content').offsetTop - 100,
          behavior: 'smooth'
        });
      }
      
      // Next section buttons
      document.querySelectorAll('.next-section-btn').forEach(button => {
        button.addEventListener('click', function() {
          const nextSectionId = this.getAttribute('data-next');
          showSection(nextSectionId);
        });
      });
      
      // Previous section buttons
      document.querySelectorAll('.prev-section-btn').forEach(button => {
        button.addEventListener('click', function() {
          const prevSectionId = this.getAttribute('data-prev');
          showSection(prevSectionId);
        });
      });
      
  
      const initialReference = document.querySelector('#section1 .lesson-reference');
      if (initialReference) {
        const verseRange = initialReference.getAttribute('data-verses');
        highlightVerses(verseRange);
      }
      
      // Quiz functionality
      const quizForm = document.getElementById('quiz-form');
      const quizQuestions = document.querySelectorAll('.quiz-question');
      const quizResults = document.getElementById('quiz-results');
      const quizScore = document.getElementById('quiz-score');
      const quizFeedback = document.getElementById('quiz-feedback');
      const retryQuizBtn = document.getElementById('retry-quiz-btn');
      const completeLessonBtn = document.getElementById('complete-lesson-btn');
      const quizProgressText = document.getElementById('quiz-progress-text');
      const quizProgressFill = document.querySelector('.quiz-progress-fill');
      const bibleTextSection = document.querySelector('.bible-text');
      let currentQuestionIndex = 0;
      let userAnswers = {};
      let questionSubmitted = {};

      // 初始化时隐藏圣经文本
      function toggleBibleText(show) {
        if (show) {
          bibleTextSection.style.display = 'block';
        } else {
          bibleTextSection.style.display = 'none';
        }
      }

      // 显示指定问题
      function showQuestion(index) {
        quizQuestions.forEach((question, i) => {
          if (i === index) {
            question.classList.remove('hidden');
          } else {
            question.classList.add('hidden');
          }
        });
        
        // 更新进度条
        currentQuestionIndex = index;
        quizProgressText.textContent = `Question ${index + 1} of ${quizQuestions.length}`;
        quizProgressFill.style.width = `${((index + 1) / quizQuestions.length) * 100}%`;
        
        // 如果问题已提交，显示圣经文本，否则隐藏
        toggleBibleText(questionSubmitted[index + 1]);
      }

      // 提交问题答案
      function submitQuestion(questionNumber, verseRange) {
        const questionIndex = questionNumber - 1;
        const selectedOption = document.querySelector(`input[name="q${questionNumber}"]:checked`);
        const feedbackElement = document.querySelector(`#question${questionNumber} .quiz-feedback`);
        const hintElement = document.querySelector(`#question${questionNumber} .quiz-hint`);
        const submitButton = document.querySelector(`#question${questionNumber} .submit-question-btn`);
        const nextButton = document.createElement('button');
        nextButton.type = 'button';
        nextButton.className = 'next-question-btn';
        
        const answers = {
          q1: 'B',
          q2: 'C',
          q3: 'B'
        };
        
        if (!selectedOption) {
          feedbackElement.innerHTML = '<p class="incorrect">Please select an answer.</p>';
          feedbackElement.classList.remove('hidden');
          return;
        }
        
        // 记录用户答案
        userAnswers[`q${questionNumber}`] = selectedOption.value;
        questionSubmitted[questionNumber] = true;
        
        // 显示提示和反馈
        hintElement.classList.remove('hidden');
        
        // 禁用选项和提交按钮
        document.querySelectorAll(`#question${questionNumber} input[type="radio"]`).forEach(input => {
          input.disabled = true;
        });
        submitButton.disabled = true;
        submitButton.style.display = 'none'; // 隐藏提交按钮
        
        // 显示反馈
        if (selectedOption.value === answers[`q${questionNumber}`]) {
          feedbackElement.innerHTML = '<p class="correct">Correct!</p>';
        } else {
          feedbackElement.innerHTML = `<p class="incorrect">Incorrect. The correct answer is ${answers[`q${questionNumber}`]}.</p>`;
        }
        feedbackElement.classList.remove('hidden');
        
        // 显示圣经文本并高亮相关经文
        toggleBibleText(true);
        highlightVerses(verseRange);
        
        // 如果不是最后一个问题，添加下一题按钮
        if (questionNumber < quizQuestions.length) {
          nextButton.textContent = 'Next Question';
          nextButton.setAttribute('data-next', questionNumber + 1);
          nextButton.addEventListener('click', function() {
            showQuestion(parseInt(this.getAttribute('data-next')) - 1);
          });
          submitButton.parentNode.appendChild(nextButton);
        } else {
          // 如果是最后一个问题，添加查看结果按钮
          nextButton.textContent = 'View Results';
          nextButton.addEventListener('click', showResults);
          submitButton.parentNode.appendChild(nextButton);
        }
      }

      // 显示测验结果
      function showResults() {
        const answers = {
          q1: 'B',
          q2: 'C',
          q3: 'B'
        };
        
        let score = 0;
        let feedback = '';
        
        // 检查答案
        for (const question in answers) {
          if (userAnswers[question] === answers[question]) {
            score++;
            feedback += `<p class="correct">Question ${question.substring(1)}: Correct!</p>`;
          } else {
            feedback += `<p class="incorrect">Question ${question.substring(1)}: Incorrect. The correct answer is ${answers[question]}.</p>`;
          }
        }
        
        // 显示结果
        quizScore.textContent = `You scored ${score} out of 3`;
        quizFeedback.innerHTML = feedback;
        
        // 隐藏问题，显示结果
        quizQuestions.forEach(question => {
          question.classList.add('hidden');
        });
        quizResults.classList.remove('hidden');
      }

      // 重置测验
      retryQuizBtn.addEventListener('click', function() {
        quizForm.reset();
        quizResults.classList.add('hidden');
        userAnswers = {};
        questionSubmitted = {};
        
        // 重置所有问题状态
        document.querySelectorAll('.quiz-hint').forEach(element => {
          element.classList.add('hidden');
        });
        
        document.querySelectorAll('.quiz-feedback').forEach(element => {
          element.classList.add('hidden');
          element.innerHTML = ''; // 清空反馈内容
        });
        
        document.querySelectorAll('.quiz-question input[type="radio"]').forEach(input => {
          input.disabled = false;
        });
        
        document.querySelectorAll('.submit-question-btn').forEach(button => {
          button.disabled = false;
          button.style.display = '';
        });
        
        document.querySelectorAll('.next-question-btn').forEach(button => {
          button.remove();
        });
        
        // 显示第一个问题
        showQuestion(0);
        toggleBibleText(false);
      });

      // 完成课程
      completeLessonBtn.addEventListener('click', function() {
        document.getElementById('quiz').classList.add('hidden');
        document.getElementById('completion').classList.remove('hidden');
        progressBar.style.width = '100%';
        progressText.textContent = '100% Complete';
        // 隐藏圣经文本
        toggleBibleText(false);
      });

      // 上一题按钮
      document.querySelectorAll('.prev-question-btn').forEach(button => {
        button.addEventListener('click', function() {
          const prevQuestionIndex = parseInt(this.getAttribute('data-prev')) - 1;
          showQuestion(prevQuestionIndex);
        });
      });

      // 提交答案按钮
      document.querySelectorAll('.submit-question-btn').forEach(button => {
        button.addEventListener('click', function() {
          const questionNumber = parseInt(this.getAttribute('data-question'));
          const verseRange = this.getAttribute('data-verses');
          submitQuestion(questionNumber, verseRange);
        });
      });

      // 初始化测验
      function initQuiz() {
        // 确保只显示第一个问题，其他都隐藏
        quizQuestions.forEach((question, i) => {
          if (i === 0) {
            question.classList.remove('hidden');
          } else {
            question.classList.add('hidden');
          }
        });
        
        // 隐藏所有提示
        document.querySelectorAll('.quiz-hint').forEach(hint => {
          hint.classList.add('hidden');
        });
        
        // 隐藏结果部分
        document.getElementById('quiz-results').classList.add('hidden');
        
        // 隐藏底部导航中的 Previous 按钮
        document.querySelector('#quiz .lesson-navigation-buttons .prev-section-btn').style.display = 'none';
        
        // 隐藏所有问题中的 Previous 按钮
        document.querySelectorAll('.prev-question-btn').forEach(button => {
          button.style.display = 'none';
        });
        
        toggleBibleText(false);
      }

      // 当进入测验部分时初始化
      document.querySelector('[data-next="quiz"]').addEventListener('click', function() {
        setTimeout(initQuiz, 100); // 给DOM更新一点时间
      });
      
      // Bible text font size controls
      const bibleContent = document.querySelector('.bible-content');
      let fontSize = 16; // Default font size
      
      document.getElementById('increase-font').addEventListener('click', function() {
        if (fontSize < 24) {
          fontSize += 2;
          bibleContent.style.fontSize = `${fontSize}px`;
        }
      });
      
      document.getElementById('decrease-font').addEventListener('click', function() {
        if (fontSize > 12) {
          fontSize -= 2;
          bibleContent.style.fontSize = `${fontSize}px`;
        }
      });
    });
  </script>
</body>
</html>
