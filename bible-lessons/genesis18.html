<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Genesis 18: Abraham's Visitors - Manna</title>
<meta name="description" content="Bible Lessons on Genesis 18 KJV: genesis 18 explained verse by verse.">
<link rel="stylesheet" href="../styles.css">
<link rel="stylesheet" href="../css/lesson-content.css">
<link rel="icon" href="../public/images/icon.png">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DF5ZGFNKTB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DF5ZGFNKTB');
</script>
</head>

<body>
<!-- Header -->
<header>
  <div class="container">
    <div class="header-content">
      <div class="logo">
        <a href="/">
          <img src="../public/images/icon.png" alt="Manna Icon">
          <span>Manna</span>
        </a>
      </div>
      <nav>
        <ul>
          <li><a href="/bible-lessons">Lessons</a></li>
          <li><a href="/prayers">Prayers</a></li>
          <li><a href="/resources">Resources</a></li>
          <li><a href="/download">Download</a></li>
        </ul>
      </nav>
      <div class="social-header">
        <a href="https://discord.gg/NbQVtWeNMa"><img src="../public/images/discard.png" alt="Discord"></a>
        <a href="https://www.instagram.com/the_manna_app"><img src="../public/images/ins.png" alt="Instagram"></a>
        <a href="https://www.tiktok.com/@manna.app"><img src="../public/images/tt.png" alt="TikTok"></a>
      </div>
    </div>
  </div>
</header>

<!-- Lesson Content -->
<section class="lesson-content-section">
  <div class="container lesson-container">
    <!-- Left Side: Lesson Content -->
    <div class="lesson-content">
      <div class="lesson-progress">
        <div class="progress-bar">
          <div class="progress-fill" style="width: 0%"></div>
        </div>
        <div class="progress-text">0% Complete</div>
      </div>

      <!-- Section 1 -->
      <div class="lesson-section" id="section1">
        <div class="lesson-card">
          <div class="lesson-card-header">
            <h2>Abraham Welcomes Three Visitors</h2>
            <div class="lesson-reference" data-verses="1-8">Genesis 18:1-8</div>
          </div>
          <div class="lesson-card-body">
            <div class="key-verse">
              <blockquote>
                "And said, My Lord, if now I have found favour in thy sight, pass not away, I pray thee, from thy servant."
                <cite>Genesis 18:3</cite>
              </blockquote>
            </div>
            <div class="key-points">
              <h3>Key Points:</h3>
              <ul>
                <li>Abraham shows hospitality to three mysterious visitors</li>
                <li>He offers food and rest, demonstrating kindness and generosity</li>
                <li>The visitors accept his offer, hinting at their divine purpose</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="lesson-detail">
          <p>Abraham was sitting near his tent when three strangers appeared. Without hesitation, he ran to greet them, bowing respectfully. He urged them to rest and brought water to wash their feet. Then, he quickly prepared a meal of bread, meat, and milk, showing great care for their comfort. This act of kindness highlights the importance of hospitality and treating others with generosity. The visitors' acceptance suggests they were more than ordinary travelers, setting the stage for what follows.</p>
        </div>
        <div class="lesson-navigation-buttons">
          <button class="next-section-btn" data-next="section2">Continue</button>
        </div>
      </div>

      <!-- Section 2 -->
      <div class="lesson-section hidden" id="section2">
        <div class="lesson-card">
          <div class="lesson-card-header">
            <h2>Sarah's Laughter and God's Promise</h2>
            <div class="lesson-reference" data-verses="9-15">Genesis 18:9-15</div>
          </div>
          <div class="lesson-card-body">
            <div class="key-verse">
              <blockquote>
                "Is any thing too hard for the LORD? At the time appointed I will return unto thee, according to the time of life, and Sarah shall have a son."
                <cite>Genesis 18:14</cite>
              </blockquote>
            </div>
            <div class="key-points">
              <h3>Key Points:</h3>
              <ul>
                <li>God reaffirms His promise that Sarah will have a son</li>
                <li>Sarah laughs in disbelief due to her old age</li>
                <li>God questions her doubt, emphasizing His power to fulfill promises</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="lesson-detail">
          <p>One of the visitors asked about Sarah, Abraham's wife, and repeated God's promise that she would have a son. Sarah, listening from the tent, laughed silently because she and Abraham were very old. The visitor, knowing her thoughts, questioned why she doubted, reminding her that nothing is impossible for God. This moment teaches that faith is needed even when promises seem unlikely, as God's plans surpass human understanding. Sarah's reaction shows how doubt can creep in, but God's reassurance remains steadfast.</p>
        </div>
        <div class="lesson-navigation-buttons">
          <button class="prev-section-btn" data-prev="section1">Previous</button>
          <button class="next-section-btn" data-next="section3">Continue</button>
        </div>
      </div>

      <!-- Section 3 -->
      <div class="lesson-section hidden" id="section3">
        <div class="lesson-card">
          <div class="lesson-card-header">
            <h2>Abraham Intercedes for Sodom</h2>
            <div class="lesson-reference" data-verses="16-33">Genesis 18:16-33</div>
          </div>
          <div class="lesson-card-body">
            <div class="key-verse">
              <blockquote>
                "That be far from thee to do after this manner, to slay the righteous with the wicked: and that the righteous should be as the wicked, that be far from thee: Shall not the Judge of all the earth do right?"
                <cite>Genesis 18:25</cite>
              </blockquote>
            </div>
            <div class="key-points">
              <h3>Key Points:</h3>
              <ul>
                <li>God reveals His plan to judge Sodom for its wickedness</li>
                <li>Abraham pleads for mercy, asking if the righteous will be spared</li>
                <li>God agrees to spare the city if even a few righteous people are found</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="lesson-detail">
          <p>As the visitors prepared to leave, God decided to share His plan about Sodom's destruction due to its great sin. Abraham, concerned for the innocent, boldly asked if God would spare the city if righteous people lived there. He negotiated with God, starting with fifty and lowering the number to ten, showing his compassion for others. God agreed, proving He is just and merciful. This conversation reveals how prayer can influence outcomes and that God values righteousness, even in the midst of judgment.</p>
        </div>
        <div class="lesson-navigation-buttons">
          <button class="prev-section-btn" data-prev="section2">Previous</button>
          <button class="next-section-btn" data-next="quiz">Test My Mastery</button>
        </div>
      </div>

      <!-- Quiz Section -->
      <div class="lesson-section hidden" id="quiz">
        <div class="lesson-card quiz-card">
          <div class="lesson-card-header">
            <h2>Level Up Test</h2>
            <div class="lesson-reference" data-verses="1-33">Genesis 18</div>
          </div>
          <div class="lesson-card-body">
            <div class="quiz-container">
              <div class="quiz-progress">
                <span id="quiz-progress-text">Question 1 of 3</span>
                <div class="quiz-progress-bar">
                  <div class="quiz-progress-fill" style="width: 33%"></div>
                </div>
              </div>
              
              <form id="quiz-form">
                <!-- Question 1 -->
                <div class="quiz-question" id="question1">
                  <h3>1. What did Abraham offer the three visitors?</h3>
                  <div class="quiz-options">
                    <div class="quiz-option">
                      <input type="radio" id="q1a" name="q1" value="A">
                      <label for="q1a">A. Gold and silver</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q1b" name="q1" value="B">
                      <label for="q1b">B. Bread, meat, and milk</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q1c" name="q1" value="C">
                      <label for="q1c">C. Clothing and sandals</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q1d" name="q1" value="D">
                      <label for="q1d">D. A place in his tent</label>
                    </div>
                  </div>
                  <div class="quiz-hint hidden">
                    <p><strong>Hint:</strong> Genesis 18:6-8</p>
                  </div>
                  <div class="quiz-feedback hidden"></div>
                  <div class="quiz-controls">
                    <div class="quiz-buttons-center">
                      <button type="button" class="submit-question-btn" data-question="1" data-verses="6-8">Submit Answer</button>
                    </div>
                  </div>
                </div>

                <!-- Question 2 -->
                <div class="quiz-question hidden" id="question2">
                  <h3>2. Why did Sarah laugh when she heard about having a son?</h3>
                  <div class="quiz-options">
                    <div class="quiz-option">
                      <input type="radio" id="q2a" name="q2" value="A">
                      <label for="q2a">A. She was overjoyed</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q2b" name="q2" value="B">
                      <label for="q2b">B. She thought it was a joke</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q2c" name="q2" value="C">
                      <label for="q2c">C. She doubted because of her old age</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q2d" name="q2" value="D">
                      <label for="q2d">D. She didn't believe Abraham</label>
                    </div>
                  </div>
                  <div class="quiz-hint hidden">
                    <p><strong>Hint:</strong> Genesis 18:12</p>
                  </div>
                  <div class="quiz-feedback hidden"></div>
                  <div class="quiz-controls">
                    <div class="quiz-buttons-center">
                      <button type="button" class="prev-question-btn" data-prev="1">Previous</button>
                      <button type="button" class="submit-question-btn" data-question="2" data-verses="12">Submit Answer</button>
                    </div>
                  </div>
                </div>

                <!-- Question 3 -->
                <div class="quiz-question hidden" id="question3">
                  <h3>3. What did Abraham ask God regarding Sodom?</h3>
                  <div class="quiz-options">
                    <div class="quiz-option">
                      <input type="radio" id="q3a" name="q3" value="A">
                      <label for="q3a">A. To destroy it immediately</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q3b" name="q3" value="B">
                      <label for="q3b">B. To spare it if righteous people were found</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q3c" name="q3" value="C">
                      <label for="q3c">C. To punish only the leaders</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q3d" name="q3" value="D">
                      <label for="q3d">D. To give him the city</label>
                    </div>
                  </div>
                  <div class="quiz-hint hidden">
                    <p><strong>Hint:</strong> Genesis 18:23-32</p>
                  </div>
                  <div class="quiz-feedback hidden"></div>
                  <div class="quiz-controls">
                    <div class="quiz-buttons-center">
                      <button type="button" class="prev-question-btn" data-prev="2">Previous</button>
                      <button type="button" class="submit-question-btn" data-question="3" data-verses="23-32">Submit Answer</button>
                    </div>
                  </div>
                </div>
              </form>

              <div id="quiz-results" class="hidden">
                <h3>Your Results</h3>
                <p id="quiz-score"></p>
                <div id="quiz-feedback"></div>
                <div class="quiz-result-buttons">
                  <button id="retry-quiz-btn">Try Again</button>
                  <button id="complete-lesson-btn">Complete Lesson</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="lesson-navigation-buttons">
          <button class="prev-section-btn" data-prev="section3">Previous</button>
        </div>
      </div>

      <!-- Completion Message (Hidden initially) -->
      <div class="lesson-completion hidden" id="completion">
        <div class="completion-card">
          <div class="completion-header">
            <div class="completion-icon">✓</div>
            <h2>Lesson Complete!</h2>
          </div>
          <div class="completion-content">
            <p class="completion-message">Congratulations on completing Genesis 18. You've learned about Abraham's hospitality and his intercession for Sodom.</p>
            
            <div class="app-promotion">
              <p class="app-promotion-text">Download the Manna App to unlock more free content.</p>
              <ul class="app-features-list">
                <li>More audio courses, Prayer, and Devotional content for Free</li>
                <li>Progress tracking, streak rewards, and grow closer to God</li>
                <li>Get answers to any Bible-related questions</li>
              </ul>
              <a href="/download" class="cta-btn">Download Manna Today</a>
            
            <div class="completion-buttons">
              <a href="/bible-lessons/genesis19" class="lesson-btn primary-btn">Next Lesson: Genesis 19</a>
              <a href="/bible-lessons" class="lesson-btn secondary-btn">Back to Lessons</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Side: Bible Text -->
    <div class="bible-text">
      <div class="bible-header">
        <h2>Genesis 18</h2>
        <div class="bible-controls">
          <button id="increase-font">A+</button>
          <button id="decrease-font">A-</button>
        </div>
      </div>
      <div class="bible-content">
        <p><sup>1</sup> And the LORD appeared unto him in the plains of Mamre: and he sat in the tent door in the heat of the day;</p>
        <p><sup>2</sup> And he lift up his eyes and looked, and, lo, three men stood by him: and when he saw them, he ran to meet them from the tent door, and bowed himself toward the ground,</p>
        <p><sup>3</sup> And said, My Lord, if now I have found favour in thy sight, pass not away, I pray thee, from thy servant:</p>
        <p><sup>4</sup> Let a little water, I pray you, be fetched, and wash your feet, and rest yourselves under the tree:</p>
        <p><sup>5</sup> And I will fetch a morsel of bread, and comfort ye your hearts; after that ye shall pass on: for therefore are ye come to your servant. And they said, So do, as thou hast said.</p>
        <p><sup>6</sup> And Abraham hastened into the tent unto Sarah, and said, Make ready quickly three measures of fine meal, knead it, and make cakes upon the hearth.</p>
        <p><sup>7</sup> And Abraham ran unto the herd, and fetcht a calf tender and good, and gave it unto a young man; and he hasted to dress it.</p>
        <p><sup>8</sup> And he took butter, and milk, and the calf which he had dressed, and set it before them; and he stood by them under the tree, and they did eat.</p>
        <p><sup>9</sup> And they said unto him, Where is Sarah thy wife? And he said, Behold, in the tent.</p>
        <p><sup>10</sup> And he said, I will certainly return unto thee according to the time of life; and, lo, Sarah thy wife shall have a son. And Sarah heard it in the tent door, which was behind him.</p>
        <p><sup>11</sup> Now Abraham and Sarah were old and well stricken in age; and it ceased to be with Sarah after the manner of women.</p>
        <p><sup>12</sup> Therefore Sarah laughed within herself, saying, After I am waxed old shall I have pleasure, my lord being old also?</p>
        <p><sup>13</sup> And the LORD said unto Abraham, Wherefore did Sarah laugh, saying, Shall I of a surety bear a child, which am old?</p>
        <p><sup>14</sup> Is any thing too hard for the LORD? At the time appointed I will return unto thee, according to the time of life, and Sarah shall have a son.</p>
        <p><sup>15</sup> Then Sarah denied, saying, I laughed not; for she was afraid. And he said, Nay; but thou didst laugh.</p>
        <p><sup>16</sup> And the men rose up from thence, and looked toward Sodom: and Abraham went with them to bring them on the way.</p>
        <p><sup>17</sup> And the LORD said, Shall I hide from Abraham that thing which I do;</p>
        <p><sup>18</sup> Seeing that Abraham shall surely become a great and mighty nation, and all the nations of the earth shall be blessed in him?</p>
        <p><sup>19</sup> For I know him, that he will command his children and his household after him, and they shall keep the way of the LORD, to do justice and judgment; that the LORD may bring upon Abraham that which he hath spoken of him.</p>
        <p><sup>20</sup> And the LORD said, Because the cry of Sodom and Gomorrah is great, and because their sin is very grievous;</p>
        <p><sup>21</sup> I will go down now, and see whether they have done altogether according to the cry of it, which is come unto me; and if not, I will know.</p>
        <p><sup>22</sup> And the men turned their faces from thence, and went toward Sodom: but Abraham stood yet before the LORD.</p>
        <p><sup>23</sup> And Abraham drew near, and said, Wilt thou also destroy the righteous with the wicked?</p>
        <p><sup>24</sup> Peradventure there be fifty righteous within the city: wilt thou also destroy and not spare the place for the fifty righteous that are therein?</p>
        <p><sup>25</sup> That be far from thee to do after this manner, to slay the righteous with the wicked: and that the righteous should be as the wicked, that be far from thee: Shall not the Judge of all the earth do right?</p>
        <p><sup>26</sup> And the LORD said, If I find in Sodom fifty righteous within the city, then I will spare all the place for their sakes.</p>
        <p><sup>27</sup> And Abraham answered and said, Behold now, I have taken upon me to speak unto the Lord, which am but dust and ashes:</p>
        <p><sup>28</sup> Peradventure there shall lack five of the fifty righteous: wilt thou destroy all the city for lack of five? And he said, If I find there forty and five, I will not destroy it.</p>
        <p><sup>29</sup> And he spake unto him yet again, and said, Peradventure there shall be forty found there. And he said, I will not do it for forty's sake.</p>
        <p><sup>30</sup> And he said unto him, Oh let not the Lord be angry, and I will speak: Peradventure there shall thirty be found there. And he said, I will not do it, if I find thirty there.</p>
        <p><sup>31</sup> And he said, Behold now, I have taken upon me to speak unto the Lord: Peradventure there shall be twenty found there. And he said, I will not destroy it for twenty's sake.</p>
        <p><sup>32</sup> And he said, Oh let not the Lord be angry, and I will speak yet but this once: Peradventure ten shall be found there. And he said, I will not destroy it for ten's sake.</p>
        <p><sup>33</sup> And the LORD went his way, as soon as he had left communing with Abraham: and Abraham returned unto his place.</p>
      </div>
    </div>
  </div>
</section>

<!-- Footer -->
<footer>
  <div class="container">
    <div class="footer-content">
      <div class="footer-column">
        <h4>Links</h4>
        <div class="social-links">
          <a href="https://discord.gg/NbQVtWeNMa"><img src="../public/images/discard.png" alt="Discord"></a>
          <a href="https://www.instagram.com/the_manna_app"><img src="../public/images/ins.png" alt="Instagram"></a>
          <a href="https://www.tiktok.com/@manna.app"><img src="../public/images/tt.png" alt="TikTok"></a>
        </div>
      </div>
      <div class="footer-column">
        <h4>Contact Us</h4>
        <p><a href="mailto:support@themanna.app">support@themanna.app</a></p>
      </div>
      <div class="footer-column">
        <h4>Legal</h4>
        <div class="legal">
          <a href="https://s.femometer.com/html_template/3027.html">Privacy Policy</a>
          <a href="https://s.femometer.com/html_template/3028.html">Terms of Service</a>
        </div>
      </div>
    </div>
    <div class="copyright">
      <p>&copy; 2025 Baymed Limited. All rights reserved.</p>
    </div>
  </div>
</footer>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Navigation between sections
    const sections = document.querySelectorAll('.lesson-section');
    const progressBar = document.querySelector('.progress-fill');
    const progressText = document.querySelector('.progress-text');
    const bibleVerses = document.querySelectorAll('.bible-content p');
    let currentSectionIndex = 0;
    const totalSections = sections.length - 1; // Excluding quiz section
    
    // Highlight and scroll to the specified scripture
    function highlightVerses(verseRange) {
      // Remove previous highlighting
      bibleVerses.forEach(verse => {
        verse.classList.remove('highlighted');
      });
      
      if (verseRange) {
        const [start, end] = verseRange.split('-').map(v => parseInt(v));
        const endVerse = end || start;
        
        // Add highlighting to the referenced scripture
        for (let i = start - 1; i < endVerse; i++) {
          if (bibleVerses[i]) {
            bibleVerses[i].classList.add('highlighted');
            
            // Scroll to the first highlighted scripture
            if (i === start - 1) {
              bibleVerses[i].scrollIntoView({
                behavior: 'smooth',
                block: 'center'
              });
            }
          }
        }
      }
    }
    
    // Update progress
    function updateProgress() {
      if (currentSectionIndex < totalSections) {
        const progress = Math.round((currentSectionIndex / totalSections) * 100);
        progressBar.style.width = `${progress}%`;
        progressText.textContent = `${progress}% Complete`;
      }
    }
    
    // Show section
    function showSection(sectionId) {
      sections.forEach(section => {
        section.classList.add('hidden');
      });
      
      const currentSection = document.getElementById(sectionId);
      currentSection.classList.remove('hidden');
      
      // Update current section index
      for (let i = 0; i < sections.length; i++) {
        if (sections[i].id === sectionId) {
          currentSectionIndex = i;
          break;
        }
      }
      
      // Automatically highlight relevant scripture
      const reference = currentSection.querySelector('.lesson-reference');
      if (reference) {
        const verseRange = reference.getAttribute('data-verses');
        highlightVerses(verseRange);
      }
      
      updateProgress();

      // If this is the quiz module, immediately hide all Previous buttons
      if (sectionId === 'quiz') {
        // Hide Previous button in bottom navigation
        document.querySelector('#quiz .lesson-navigation-buttons .prev-section-btn').style.display = 'none';
        // Hide Previous button in questions
        document.querySelectorAll('.prev-question-btn').forEach(button => {
          button.style.display = 'none';
        });
      }
      
      // Scroll to section top
      window.scrollTo({
        top: document.querySelector('.lesson-content').offsetTop - 100,
        behavior: 'smooth'
      });
    }
    
    // Next section buttons
    document.querySelectorAll('.next-section-btn').forEach(button => {
      button.addEventListener('click', function() {
        const nextSectionId = this.getAttribute('data-next');
        showSection(nextSectionId);
      });
    });
    
    // Previous section buttons
    document.querySelectorAll('.prev-section-btn').forEach(button => {
      button.addEventListener('click', function() {
        const prevSectionId = this.getAttribute('data-prev');
        showSection(prevSectionId);
      });
    });
    
    // Initialize scripture highlighting for the first section
    const initialReference = document.querySelector('#section1 .lesson-reference');
    if (initialReference) {
      const verseRange = initialReference.getAttribute('data-verses');
      highlightVerses(verseRange);
    }
    
    // Quiz functionality
    const quizForm = document.getElementById('quiz-form');
    const quizQuestions = document.querySelectorAll('.quiz-question');
    const quizResults = document.getElementById('quiz-results');
    const quizScore = document.getElementById('quiz-score');
    const quizFeedback = document.getElementById('quiz-feedback');
    const retryQuizBtn = document.getElementById('retry-quiz-btn');
    const completeLessonBtn = document.getElementById('complete-lesson-btn');
    const quizProgressText = document.getElementById('quiz-progress-text');
    const quizProgressFill = document.querySelector('.quiz-progress-fill');
    const bibleTextSection = document.querySelector('.bible-text');
    let currentQuestionIndex = 0;
    let userAnswers = {};
    let questionSubmitted = {};

    // Hide Bible text on initialization
    function toggleBibleText(show) {
      if (show) {
        bibleTextSection.style.display = 'block';
      } else {
        bibleTextSection.style.display = 'none';
      }
    }

    // Show specified question
    function showQuestion(index) {
      quizQuestions.forEach((question, i) => {
        if (i === index) {
          question.classList.remove('hidden');
        } else {
          question.classList.add('hidden');
        }
      });
      
      // Update progress bar
      currentQuestionIndex = index;
      quizProgressText.textContent = `Question ${index + 1} of ${quizQuestions.length}`;
      quizProgressFill.style.width = `${((index + 1) / quizQuestions.length) * 100}%`;
      
      // If question is submitted, show Bible text, otherwise hide it
      toggleBibleText(questionSubmitted[index + 1]);
    }

    // Submit question answer
    function submitQuestion(questionNumber, verseRange) {
      const questionIndex = questionNumber - 1;
      const selectedOption = document.querySelector(`input[name="q${questionNumber}"]:checked`);
      const feedbackElement = document.querySelector(`#question${questionNumber} .quiz-feedback`);
      const hintElement = document.querySelector(`#question${questionNumber} .quiz-hint`);
      const submitButton = document.querySelector(`#question${questionNumber} .submit-question-btn`);
      const nextButton = document.createElement('button');
      nextButton.type = 'button';
      nextButton.className = 'next-question-btn';
      
      const answers = {
        q1: 'B',
        q2: 'C',
        q3: 'B'
      };
      
      if (!selectedOption) {
        feedbackElement.innerHTML = '<p class="incorrect">Please select an answer.</p>';
        feedbackElement.classList.remove('hidden');
        return;
      }
      
      // Record user answer
      userAnswers[`q${questionNumber}`] = selectedOption.value;
      questionSubmitted[questionNumber] = true;
      
      // Show hint and feedback
      hintElement.classList.remove('hidden');
      
      // Disable options and submit button
      document.querySelectorAll(`#question${questionNumber} input[type="radio"]`).forEach(input => {
        input.disabled = true;
      });
      submitButton.disabled = true;
      submitButton.style.display = 'none'; // Hide submit button
      
      // Show feedback
      if (selectedOption.value === answers[`q${questionNumber}`]) {
        feedbackElement.innerHTML = '<p class="correct">Correct!</p>';
      } else {
        feedbackElement.innerHTML = `<p class="incorrect">Incorrect. The correct answer is ${answers[`q${questionNumber}`]}.</p>`;
      }
      feedbackElement.classList.remove('hidden');
      
      // Show Bible text and highlight relevant verses
      toggleBibleText(true);
      highlightVerses(verseRange);
      
      // If not the last question, add next question button
      if (questionNumber < quizQuestions.length) {
        nextButton.textContent = 'Next Question';
        nextButton.setAttribute('data-next', questionNumber + 1);
        nextButton.addEventListener('click', function() {
          showQuestion(parseInt(this.getAttribute('data-next')) - 1);
        });
        submitButton.parentNode.appendChild(nextButton);
      } else {
        // If last question, add view results button
        nextButton.textContent = 'View Results';
        nextButton.addEventListener('click', showResults);
        submitButton.parentNode.appendChild(nextButton);
      }
    }

    // Show quiz results
    function showResults() {
      const answers = {
        q1: 'B',
        q2: 'C',
        q3: 'B'
      };
      
      let score = 0;
      let feedback = '';
      
      // Check answers
      for (const question in answers) {
        if (userAnswers[question] === answers[question]) {
          score++;
          feedback += `<p class="correct">Question ${question.substring(1)}: Correct!</p>`;
        } else {
          feedback += `<p class="incorrect">Question ${question.substring(1)}: Incorrect. The correct answer is ${answers[question]}.</p>`;
        }
      }
      
      // Show results
      quizScore.textContent = `You scored ${score} out of 3`;
      quizFeedback.innerHTML = feedback;
      
      // Hide questions, show results
      quizQuestions.forEach(question => {
        question.classList.add('hidden');
      });
      quizResults.classList.remove('hidden');
    }

    // Reset quiz
    retryQuizBtn.addEventListener('click', function() {
      quizForm.reset();
      quizResults.classList.add('hidden');
      userAnswers = {};
      questionSubmitted = {};
      
      // Reset all question states
      document.querySelectorAll('.quiz-hint').forEach(element => {
        element.classList.add('hidden');
      });
      
      document.querySelectorAll('.quiz-feedback').forEach(element => {
        element.classList.add('hidden');
        element.innerHTML = ''; // Clear feedback content
      });
      
      document.querySelectorAll('.quiz-question input[type="radio"]').forEach(input => {
        input.disabled = false;
      });
      
      document.querySelectorAll('.submit-question-btn').forEach(button => {
        button.disabled = false;
        button.style.display = '';
      });
      
      document.querySelectorAll('.next-question-btn').forEach(button => {
        button.remove();
      });
      
      // Show first question
      showQuestion(0);
      toggleBibleText(false);
    });

    // Complete lesson
    completeLessonBtn.addEventListener('click', function() {
      document.getElementById('quiz').classList.add('hidden');
      document.getElementById('completion').classList.remove('hidden');
      progressBar.style.width = '100%';
      progressText.textContent = '100% Complete';
      // Hide Bible text
      toggleBibleText(false);
    });

    // Previous question button
    document.querySelectorAll('.prev-question-btn').forEach(button => {
      button.addEventListener('click', function() {
        const prevQuestionIndex = parseInt(this.getAttribute('data-prev')) - 1;
        showQuestion(prevQuestionIndex);
      });
    });

    // Submit answer button
    document.querySelectorAll('.submit-question-btn').forEach(button => {
      button.addEventListener('click', function() {
        const questionNumber = parseInt(this.getAttribute('data-question'));
        const verseRange = this.getAttribute('data-verses');
        submitQuestion(questionNumber, verseRange);
      });
    });

    // Initialize quiz
    function initQuiz() {
      // Ensure only the first question is displayed, hide others
      quizQuestions.forEach((question, i) => {
        if (i === 0) {
          question.classList.remove('hidden');
        } else {
          question.classList.add('hidden');
        }
      });
      
      // Hide all hints
      document.querySelectorAll('.quiz-hint').forEach(hint => {
        hint.classList.add('hidden');
      });
      
      // Hide results section
      document.getElementById('quiz-results').classList.add('hidden');
      
      // Hide Previous button in bottom navigation
      document.querySelector('#quiz .lesson-navigation-buttons .prev-section-btn').style.display = 'none';
      
      // Hide Previous button in all questions
      document.querySelectorAll('.prev-question-btn').forEach(button => {
        button.style.display = 'none';
      });
      
      toggleBibleText(false);
    }

    // Initialize when entering quiz section
    document.querySelector('[data-next="quiz"]').addEventListener('click', function() {
      setTimeout(initQuiz, 100); // Give DOM update a little time
    });
    
    // Bible text font size controls
    const bibleContent = document.querySelector('.bible-content');
    let fontSize = 16; // Default font size
    
    document.getElementById('increase-font').addEventListener('click', function() {
      if (fontSize < 24) {
        fontSize += 2;
        bibleContent.style.fontSize = `${fontSize}px`;
      }
    });
    
    document.getElementById('decrease-font').addEventListener('click', function() {
      if (fontSize > 12) {
        fontSize -= 2;
        bibleContent.style.fontSize = `${fontSize}px`;
      }
    });
  });
</script>
</body>
</html>
