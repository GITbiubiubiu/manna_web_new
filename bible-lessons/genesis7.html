<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Genesis 7: The Great Flood - Manna</title>
  <meta name="description" content="Bible Lessons on Genesis 7 KJV: genesis 7 explained verse by verse.">
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="../css/lesson-content.css">
  <link rel="icon" href="../public/images/icon.png">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DF5ZGFNKTB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DF5ZGFNKTB');
  </script>
</head>

<body>
  <!-- Header -->
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <a href="/">
            <img src="../public/images/icon.png" alt="Manna Icon">
            <span>Manna</span>
          </a>
        </div>
        <nav>
          <ul>
            <li><a href="/bible-lessons">Lessons</a></li>
            <li><a href="/prayers">Prayers</a></li>
            <li><a href="/resources">Resources</a></li>
            <li><a href="/download">Download</a></li>
          </ul>
        </nav>
        <div class="social-header">
          <a href="https://discord.gg/NbQVtWeNMa"><img src="../public/images/discard.png" alt="Discord"></a>
          <a href="https://www.instagram.com/the_manna_app"><img src="../public/images/ins.png" alt="Instagram"></a>
          <a href="https://www.tiktok.com/@manna.app"><img src="../public/images/tt.png" alt="TikTok"></a>
        </div>
      </div>
    </div>
  </header>

  <!-- Lesson Content -->
  <section class="lesson-content-section">
    <div class="container lesson-container">
      <!-- Left Side: Lesson Content -->
      <div class="lesson-content">
        <div class="lesson-progress">
          <div class="progress-bar">
            <div class="progress-fill" style="width: 0%"></div>
          </div>
          <div class="progress-text">0% Complete</div>
        </div>

        <!-- Section 1 -->
        <div class="lesson-section" id="section1">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>God's Command to Enter the Ark</h2>
              <div class="lesson-reference" data-verses="1-5">Genesis 7:1-5</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "And the LORD said unto Noah, Come thou and all thy house into the ark; for thee have I seen righteous before me in this generation."
                  <cite>Genesis 7:1</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>God instructs Noah and his family to enter the ark for safety</li>
                  <li>Noah is told to bring pairs of every kind of animal to preserve life</li>
                  <li>God warns of the coming flood and the destruction it will bring</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>God tells Noah to enter the ark with his family because He is about to send a great flood. Noah is also instructed to take male and female pairs of every animal to keep them alive. This shows God's care for both humans and animals, ensuring life continues after the flood. Noah's willingness to follow God's instructions highlights his trust in God's plan, even when it seemed unusual. This teaches us the importance of listening and obeying when we feel guided to do something important.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="next-section-btn" data-next="section2">Continue</button>
          </div>
        </div>

        <!-- Section 2 -->
        <div class="lesson-section hidden" id="section2">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>Noah's Obedience and the Flood Begins</h2>
              <div class="lesson-reference" data-verses="6-10">Genesis 7:6-10</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "And Noah did according unto all that the LORD commanded him."
                  <cite>Genesis 7:5</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>Noah follows God's instructions exactly as commanded</li>
                  <li>The floodwaters start to cover the earth as God had said</li>
                  <li>Noah's obedience demonstrates his faith in God's plan</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>Noah does everything exactly as God commands him, showing his complete faith. When the flood begins, it happens just as God had warned, proving that God keeps His promises. Noah's actions remind us that obedience often requires patience and trust, especially when we don't see immediate results. His example encourages us to stay faithful even when things around us seem uncertain or difficult.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section1">Previous</button>
            <button class="next-section-btn" data-next="section3">Continue</button>
          </div>
        </div>

        <!-- Section 3 -->
        <div class="lesson-section hidden" id="section3">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>The Great Flood Covers the Earth</h2>
              <div class="lesson-reference" data-verses="11-16">Genesis 7:11-16</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "In the six hundredth year of Noah's life, in the second month, the seventeenth day of the month, the same day were all the fountains of the great deep broken up, and the windows of heaven were opened."
                  <cite>Genesis 7:11</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>Heavy rains and underground waters cause a massive flood</li>
                  <li>All living creatures outside the ark perish in the waters</li>
                  <li>God shuts Noah and the animals safely inside the ark</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>The flood starts with heavy rains and water bursting from underground, covering the entire earth. Every creature outside the ark is destroyed, showing the seriousness of God's judgment. Yet, Noah and his family are kept safe inside the ark, demonstrating God's protection over those who follow Him. This event reminds us that while consequences for wrongdoing are real, God also provides a way of safety for those who trust Him.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section2">Previous</button>
            <button class="next-section-btn" data-next="section4">Continue</button>
          </div>
        </div>

        <!-- Section 4 -->
        <div class="lesson-section hidden" id="section4">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>The Flood's Destruction and Duration</h2>
              <div class="lesson-reference" data-verses="17-24">Genesis 7:17-24</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "And every living substance was destroyed which was upon the face of the ground, both man, and cattle, and the creeping things, and the fowl of the heaven; and they were destroyed from the earth: and Noah only remained alive, and they that were with him in the ark."
                  <cite>Genesis 7:23</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>The floodwaters rise so high they cover even the mountains</li>
                  <li>Every living thing on earth is wiped out except those in the ark</li>
                  <li>The waters remain for a long time, showing the extent of God's judgment</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>The floodwaters rise so high that even the tallest mountains are submerged. Every living thing on earth is wiped out, except for those in the ark. The waters stay for a long time, showing how thorough God's judgment is. This part of the story teaches us that God's plans are complete and purposeful, even when they involve difficult times. It also reassures us that God's promises, whether of judgment or protection, are always fulfilled.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section3">Previous</button>
            <button class="next-section-btn" data-next="quiz">Test My Mastery</button>
          </div>
        </div>

        <!-- Quiz Section -->
        <div class="lesson-section hidden" id="quiz">
          <div class="lesson-card quiz-card">
            <div class="lesson-card-header">
              <h2>Level Up Test</h2>
              <div class="lesson-reference" data-verses="1-24">Genesis 7</div>
            </div>
            <div class="lesson-card-body">
              <div class="quiz-container">
                <div class="quiz-progress">
                  <span id="quiz-progress-text">Question 1 of 3</span>
                  <div class="quiz-progress-bar">
                    <div class="quiz-progress-fill" style="width: 33%"></div>
                  </div>
                </div>
                
                <form id="quiz-form">
                  <!-- Question 1 -->
                  <div class="quiz-question" id="question1">
                    <h3>1. Why did God tell Noah to enter the ark?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q1a" name="q1" value="A">
                        <label for="q1a">A. To protect him from a great flood</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1b" name="q1" value="B">
                        <label for="q1b">B. To start a new journey</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1c" name="q1" value="C">
                        <label for="q1c">C. To hide from enemies</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1d" name="q1" value="D">
                        <label for="q1d">D. To store food for winter</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 7:1</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="submit-question-btn" data-question="1" data-verses="1">Submit Answer</button>
                      </div>
                    </div>
                  </div>

                  <!-- Question 2 -->
                  <div class="quiz-question hidden" id="question2">
                    <h3>2. What happened to the creatures outside the ark?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q2a" name="q2" value="A">
                        <label for="q2a">A. They were saved by swimming</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2b" name="q2" value="B">
                        <label for="q2b">B. They found another shelter</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2c" name="q2" value="C">
                        <label for="q2c">C. They perished in the flood</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2d" name="q2" value="D">
                        <label for="q2d">D. They flew away to safety</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 7:21-23</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="prev-question-btn" data-prev="1">Previous</button>
                        <button type="button" class="submit-question-btn" data-question="2" data-verses="21-23">Submit Answer</button>
                      </div>
                    </div>
                  </div>

                  <!-- Question 3 -->
                  <div class="quiz-question hidden" id="question3">
                    <h3>3. How long did the floodwaters cover the earth?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q3a" name="q3" value="A">
                        <label for="q3a">A. A few days</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3b" name="q3" value="B">
                        <label for="q3b">B. Several weeks</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3c" name="q3" value="C">
                        <label for="q3c">C. Many months</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3d" name="q3" value="D">
                        <label for="q3d">D. A couple of years</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 7:24</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="prev-question-btn" data-prev="2">Previous</button>
                        <button type="button" class="submit-question-btn" data-question="3" data-verses="24">Submit Answer</button>
                      </div>
                    </div>
                  </div>
                </form>

                <div id="quiz-results" class="hidden">
                  <h3>Your Results</h3>
                  <p id="quiz-score"></p>
                  <div id="quiz-feedback"></div>
                  <div class="quiz-result-buttons">
                    <button id="retry-quiz-btn">Try Again</button>
                    <button id="complete-lesson-btn">Complete Lesson</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section4">Previous</button>
          </div>
        </div>

        <!-- Completion Message (Hidden initially) -->
        <div class="lesson-completion hidden" id="completion">
          <div class="completion-card">
            <div class="completion-header">
              <div class="completion-icon">✓</div>
              <h2>Lesson Complete!</h2>
            </div>
            <div class="completion-content">
              <p class="completion-message">Congratulations on completing Genesis 7. You've learned about Noah's obedience and the great flood that covered the earth.</p>
              
              <div class="app-promotion">
                <p class="app-promotion-text">Download the Manna App to unlock more free content.</p>
                <ul class="app-features-list">
                  <li>More audio courses, Prayer, and Devotional content for Free</li>
                  <li>Progress tracking, streak rewards, and grow closer to God</li>
                  <li>Get answers to any Bible-related questions</li>
                </ul>
                <div class="download-options">
                  <div class="qr-code">
                    <img src="../public/images/qrcode.png" alt="QR Code to download Manna App">
                  </div>
                  <div class="app-store-links">
                    <a href="https://apps.apple.com/us/app/manna-bible-study-prayer/id1669523799" class="app-store-link">
                      <img src="../public/images/download.png" alt="Download on App Store">
                    </a>
                  </div>
                </div>
              </div>
              
              <div class="completion-buttons">
                <a href="/bible-lessons/genesis8" class="lesson-btn primary-btn">Next Lesson: Genesis 8</a>
                <a href="/bible-lessons" class="lesson-btn secondary-btn">Back to Lessons</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Side: Bible Text -->
      <div class="bible-text">
        <div class="bible-header">
          <h2>Genesis 7</h2>
          <div class="bible-controls">
            <button id="increase-font">A+</button>
            <button id="decrease-font">A-</button>
          </div>
        </div>
        <div class="bible-content">
          <p><sup>1</sup> And the LORD said unto Noah, Come thou and all thy house into the ark; for thee have I seen righteous before me in this generation.</p>
          <p><sup>2</sup> Of every clean beast thou shalt take to thee by sevens, the male and his female: and of beasts that are not clean by two, the male and his female.</p>
          <p><sup>3</sup> Of fowls also of the air by sevens, the male and the female; to keep seed alive upon the face of all the earth.</p>
          <p><sup>4</sup> For yet seven days, and I will cause it to rain upon the earth forty days and forty nights; and every living substance that I have made will I destroy from off the face of the earth.</p>
          <p><sup>5</sup> And Noah did according unto all that the LORD commanded him.</p>
          <p><sup>6</sup> And Noah was six hundred years old when the flood of waters was upon the earth.</p>
          <p><sup>7</sup> And Noah went in, and his sons, and his wife, and his sons' wives with him, into the ark, because of the waters of the flood.</p>
          <p><sup>8</sup> Of clean beasts, and of beasts that are not clean, and of fowls, and of every thing that creepeth upon the earth,</p>
          <p><sup>9</sup> There went in two and two unto Noah into the ark, the male and the female, as God had commanded Noah.</p>
          <p><sup>10</sup> And it came to pass after seven days, that the waters of the flood were upon the earth.</p>
          <p><sup>11</sup> In the six hundredth year of Noah's life, in the second month, the seventeenth day of the month, the same day were all the fountains of the great deep broken up, and the windows of heaven were opened.</p>
          <p><sup>12</sup> And the rain was upon the earth forty days and forty nights.</p>
          <p><sup>13</sup> In the selfsame day entered Noah, and Shem, and Ham, and Japheth, the sons of Noah, and Noah's wife, and the three wives of his sons with them, into the ark;</p>
          <p><sup>14</sup> They, and every beast after his kind, and all the cattle after their kind, and every creeping thing that creepeth upon the earth after his kind, and every fowl after his kind, every bird of every sort.</p>
          <p><sup>15</sup> And they went in unto Noah into the ark, two and two of all flesh, wherein is the breath of life.</p>
          <p><sup>16</sup> And they that went in, went in male and female of all flesh, as God had commanded him: and the LORD shut him in.</p>
          <p><sup>17</sup> And the flood was forty days upon the earth; and the waters increased, and bare up the ark, and it was lift up above the earth.</p>
          <p><sup>18</sup> And the waters prevailed, and were increased greatly upon the earth; and the ark went upon the face of the waters.</p>
          <p><sup>19</sup> And the waters prevailed exceedingly upon the earth; and all the high hills, that were under the whole heaven, were covered.</p>
          <p><sup>20</sup> Fifteen cubits upward did the waters prevail; and the mountains were covered.</p>
          <p><sup>21</sup> And all flesh died that moved upon the earth, both of fowl, and of cattle, and of beast, and of every creeping thing that creepeth upon the earth, and every man:</p>
          <p><sup>22</sup> All in whose nostrils was the breath of life, of all that was in the dry land, died.</p>
          <p><sup>23</sup> And every living substance was destroyed which was upon the face of the ground, both man, and cattle, and the creeping things, and the fowl of the heaven; and they were destroyed from the earth: and Noah only remained alive, and they that were with him in the ark.</p>
          <p><sup>24</sup> And the waters prevailed upon the earth an hundred and fifty days.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-column">
          <h4>Links</h4>
          <div class="social-links">
            <a href="https://discord.gg/NbQVtWeNMa"><img src="../public/images/discard.png" alt="Discord"></a>
            <a href="https://www.instagram.com/the_manna_app"><img src="../public/images/ins.png" alt="Instagram"></a>
            <a href="https://www.tiktok.com/@manna.app"><img src="../public/images/tt.png" alt="TikTok"></a>
          </div>
        </div>
        <div class="footer-column">
          <h4>Contact Us</h4>
          <p><a href="mailto:support@themanna.app">support@themanna.app</a></p>
        </div>
        <div class="footer-column">
          <h4>Legal</h4>
          <div class="legal">
            <a href="https://s.femometer.com/html_template/3027.html">Privacy Policy</a>
            <a href="https://s.femometer.com/html_template/3028.html">Terms of Service</a>
          </div>
        </div>
      </div>
      <div class="copyright">
        <p>&copy; 2025 Baymed Limited. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Navigation between sections
      const sections = document.querySelectorAll('.lesson-section');
      const progressBar = document.querySelector('.progress-fill');
      const progressText = document.querySelector('.progress-text');
      const bibleVerses = document.querySelectorAll('.bible-content p');
      let currentSectionIndex = 0;
      const totalSections = sections.length - 1; // Excluding quiz section
      
      // 高亮并滚动到指定的经文
      function highlightVerses(verseRange) {
        // 移除之前的高亮
        bibleVerses.forEach(verse => {
          verse.classList.remove('highlighted');
        });
        
        if (verseRange) {
          const [start, end] = verseRange.split('-').map(v => parseInt(v));
          const endVerse = end || start;
          
          // 添加高亮到引用的经文
          for (let i = start - 1; i < endVerse; i++) {
            if (bibleVerses[i]) {
              bibleVerses[i].classList.add('highlighted');
              
              // 滚动到第一个高亮的经文
              if (i === start - 1) {
                bibleVerses[i].scrollIntoView({
                  behavior: 'smooth',
                  block: 'center'
                });
              }
            }
          }
        }
      }
      
      // Update progress
      function updateProgress() {
        if (currentSectionIndex < totalSections) {
          const progress = Math.round((currentSectionIndex / totalSections) * 100);
          progressBar.style.width = `${progress}%`;
          progressText.textContent = `${progress}% Complete`;
        }
      }
      
      // Show section
      function showSection(sectionId) {
        sections.forEach(section => {
          section.classList.add('hidden');
        });
        
        const currentSection = document.getElementById(sectionId);
        currentSection.classList.remove('hidden');
        
        // 更新当前部分索引
        for (let i = 0; i < sections.length; i++) {
          if (sections[i].id === sectionId) {
            currentSectionIndex = i;
            break;
          }
        }
        
        // 自动高亮相关经文
        const reference = currentSection.querySelector('.lesson-reference');
        if (reference) {
          const verseRange = reference.getAttribute('data-verses');
          highlightVerses(verseRange);
        }
        
        updateProgress();

        // 如果是测试模块，立即隐藏所有 Previous 按钮
        if (sectionId === 'quiz') {
          // 隐藏底部导航中的 Previous 按钮
          document.querySelector('#quiz .lesson-navigation-buttons .prev-section-btn').style.display = 'none';
          // 隐藏问题中的 Previous 按钮
          document.querySelectorAll('.prev-question-btn').forEach(button => {
            button.style.display = 'none';
          });
        }
        
        // 滚动到部分顶部
        window.scrollTo({
          top: document.querySelector('.lesson-content').offsetTop - 100,
          behavior: 'smooth'
        });
      }
      
      // Next section buttons
      document.querySelectorAll('.next-section-btn').forEach(button => {
        button.addEventListener('click', function() {
          const nextSectionId = this.getAttribute('data-next');
          showSection(nextSectionId);
        });
      });
      
      // Previous section buttons
      document.querySelectorAll('.prev-section-btn').forEach(button => {
        button.addEventListener('click', function() {
          const prevSectionId = this.getAttribute('data-prev');
          showSection(prevSectionId);
        });
      });
      
  
      const initialReference = document.querySelector('#section1 .lesson-reference');
      if (initialReference) {
        const verseRange = initialReference.getAttribute('data-verses');
        highlightVerses(verseRange);
      }
      
      // Quiz functionality
      const quizForm = document.getElementById('quiz-form');
      const quizQuestions = document.querySelectorAll('.quiz-question');
      const quizResults = document.getElementById('quiz-results');
      const quizScore = document.getElementById('quiz-score');
      const quizFeedback = document.getElementById('quiz-feedback');
      const retryQuizBtn = document.getElementById('retry-quiz-btn');
      const completeLessonBtn = document.getElementById('complete-lesson-btn');
      const quizProgressText = document.getElementById('quiz-progress-text');
      const quizProgressFill = document.querySelector('.quiz-progress-fill');
      const bibleTextSection = document.querySelector('.bible-text');
      let currentQuestionIndex = 0;
      let userAnswers = {};
      let questionSubmitted = {};

      // 初始化时隐藏圣经文本
      function toggleBibleText(show) {
        if (show) {
          bibleTextSection.style.display = 'block';
        } else {
          bibleTextSection.style.display = 'none';
        }
      }

      // 显示指定问题
      function showQuestion(index) {
        quizQuestions.forEach((question, i) => {
          if (i === index) {
            question.classList.remove('hidden');
          } else {
            question.classList.add('hidden');
          }
        });
        
        // 更新进度条
        currentQuestionIndex = index;
        quizProgressText.textContent = `Question ${index + 1} of ${quizQuestions.length}`;
        quizProgressFill.style.width = `${((index + 1) / quizQuestions.length) * 100}%`;
        
        // 如果问题已提交，显示圣经文本，否则隐藏
        toggleBibleText(questionSubmitted[index + 1]);
      }

      // 提交问题答案
      function submitQuestion(questionNumber, verseRange) {
        const questionIndex = questionNumber - 1;
        const selectedOption = document.querySelector(`input[name="q${questionNumber}"]:checked`);
        const feedbackElement = document.querySelector(`#question${questionNumber} .quiz-feedback`);
        const hintElement = document.querySelector(`#question${questionNumber} .quiz-hint`);
        const submitButton = document.querySelector(`#question${questionNumber} .submit-question-btn`);
        const nextButton = document.createElement('button');
        nextButton.type = 'button';
        nextButton.className = 'next-question-btn';
        
        const answers = {
          q1: 'A',
          q2: 'C',
          q3: 'C'
        };
        
        if (!selectedOption) {
          feedbackElement.innerHTML = '<p class="incorrect">Please select an answer.</p>';
          feedbackElement.classList.remove('hidden');
          return;
        }
        
        // 记录用户答案
        userAnswers[`q${questionNumber}`] = selectedOption.value;
        questionSubmitted[questionNumber] = true;
        
        // 显示提示和反馈
        hintElement.classList.remove('hidden');
        
        // 禁用选项和提交按钮
        document.querySelectorAll(`#question${questionNumber} input[type="radio"]`).forEach(input => {
          input.disabled = true;
        });
        submitButton.disabled = true;
        submitButton.style.display = 'none'; // 隐藏提交按钮
        
        // 显示反馈
        if (selectedOption.value === answers[`q${questionNumber}`]) {
          feedbackElement.innerHTML = '<p class="correct">Correct!</p>';
        } else {
          feedbackElement.innerHTML = `<p class="incorrect">Incorrect. The correct answer is ${answers[`q${questionNumber}`]}.</p>`;
        }
        feedbackElement.classList.remove('hidden');
        
        // 显示圣经文本并高亮相关经文
        toggleBibleText(true);
        highlightVerses(verseRange);
        
        // 如果不是最后一个问题，添加下一题按钮
        if (questionNumber < quizQuestions.length) {
          nextButton.textContent = 'Next Question';
          nextButton.setAttribute('data-next', questionNumber + 1);
          nextButton.addEventListener('click', function() {
            showQuestion(parseInt(this.getAttribute('data-next')) - 1);
          });
          submitButton.parentNode.appendChild(nextButton);
        } else {
          // 如果是最后一个问题，添加查看结果按钮
          nextButton.textContent = 'View Results';
          nextButton.addEventListener('click', showResults);
          submitButton.parentNode.appendChild(nextButton);
        }
      }

      // 显示测验结果
      function showResults() {
        const answers = {
          q1: 'A',
          q2: 'C',
          q3: 'C'
        };
        
        let score = 0;
        let feedback = '';
        
        // 检查答案
        for (const question in answers) {
          if (userAnswers[question] === answers[question]) {
            score++;
            feedback += `<p class="correct">Question ${question.substring(1)}: Correct!</p>`;
          } else {
            feedback += `<p class="incorrect">Question ${question.substring(1)}: Incorrect. The correct answer is ${answers[question]}.</p>`;
          }
        }
        
        // 显示结果
        quizScore.textContent = `You scored ${score} out of 3`;
        quizFeedback.innerHTML = feedback;
        
        // 隐藏问题，显示结果
        quizQuestions.forEach(question => {
          question.classList.add('hidden');
        });
        quizResults.classList.remove('hidden');
      }

      // 重置测验
      retryQuizBtn.addEventListener('click', function() {
        quizForm.reset();
        quizResults.classList.add('hidden');
        userAnswers = {};
        questionSubmitted = {};
        
        // 重置所有问题状态
        document.querySelectorAll('.quiz-hint').forEach(element => {
          element.classList.add('hidden');
        });
        
        document.querySelectorAll('.quiz-feedback').forEach(element => {
          element.classList.add('hidden');
          element.innerHTML = ''; // 清空反馈内容
        });
        
        document.querySelectorAll('.quiz-question input[type="radio"]').forEach(input => {
          input.disabled = false;
        });
        
        document.querySelectorAll('.submit-question-btn').forEach(button => {
          button.disabled = false;
          button.style.display = '';
        });
        
        document.querySelectorAll('.next-question-btn').forEach(button => {
          button.remove();
        });
        
        // 显示第一个问题
        showQuestion(0);
        toggleBibleText(false);
      });

      // 完成课程
      completeLessonBtn.addEventListener('click', function() {
        document.getElementById('quiz').classList.add('hidden');
        document.getElementById('completion').classList.remove('hidden');
        progressBar.style.width = '100%';
        progressText.textContent = '100% Complete';
        // 隐藏圣经文本
        toggleBibleText(false);
      });

      // 上一题按钮
      document.querySelectorAll('.prev-question-btn').forEach(button => {
        button.addEventListener('click', function() {
          const prevQuestionIndex = parseInt(this.getAttribute('data-prev')) - 1;
          showQuestion(prevQuestionIndex);
        });
      });

      // 提交答案按钮
      document.querySelectorAll('.submit-question-btn').forEach(button => {
        button.addEventListener('click', function() {
          const questionNumber = parseInt(this.getAttribute('data-question'));
          const verseRange = this.getAttribute('data-verses');
          submitQuestion(questionNumber, verseRange);
        });
      });

      // 初始化测��
      function initQuiz() {
        // 确保只显示第一个问题，其他都隐藏
        quizQuestions.forEach((question, i) => {
          if (i === 0) {
            question.classList.remove('hidden');
          } else {
            question.classList.add('hidden');
          }
        });
        
        // 隐藏所有提示
        document.querySelectorAll('.quiz-hint').forEach(hint => {
          hint.classList.add('hidden');
        });
        
        // 隐藏结果部分
        document.getElementById('quiz-results').classList.add('hidden');
        
        // 隐藏底部导航中的 Previous 按钮
        document.querySelector('#quiz .lesson-navigation-buttons .prev-section-btn').style.display = 'none';
        
        // 隐藏所有问题中的 Previous 按钮
        document.querySelectorAll('.prev-question-btn').forEach(button => {
          button.style.display = 'none';
        });
        
        toggleBibleText(false);
      }

      // 当进入测验部分时初��化
      document.querySelector('[data-next="quiz"]').addEventListener('click', function() {
        setTimeout(initQuiz, 100); // 给DOM更新一点时间
      });
      
      // Bible text font size controls
      const bibleContent = document.querySelector('.bible-content');
      let fontSize = 16; // Default font size
      
      document.getElementById('increase-font').addEventListener('click', function() {
        if (fontSize < 24) {
          fontSize += 2;
          bibleContent.style.fontSize = `${fontSize}px`;
        }
      });
      
      document.getElementById('decrease-font').addEventListener('click', function() {
        if (fontSize > 12) {
          fontSize -= 2;
          bibleContent.style.fontSize = `${fontSize}px`;
        }
      });
    });
  </script>
</body>
</html>
