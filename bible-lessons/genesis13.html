<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Genesis 12: God's Call to Abram - Manna</title>
  <meta name="description" content="Bible Lessons on Genesis 12 KJV: genesis 12 explained verse by verse.">
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="../css/lesson-content.css">
  <link rel="icon" href="../public/images/icon.png">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DF5ZGFNKTB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DF5ZGFNKTB');
  </script>
</head>

<body>
  <!-- Header -->
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <a href="/">
            <img src="../public/images/icon.png" alt="Manna Icon">
            <span>Manna</span>
          </a>
        </div>
        <nav>
          <ul>
            <li><a href="/bible-lessons">Lessons</a></li>
            <li><a href="/prayers">Prayers</a></li>
            <li><a href="/resources">Resources</a></li>
            <li><a href="/download">Download</a></li>
          </ul>
        </nav>
        <div class="social-header">
          <a href="https://discord.gg/NbQVtWeNMa"><img src="../public/images/discard.png" alt="Discord"></a>
          <a href="https://www.instagram.com/the_manna_app"><img src="../public/images/ins.png" alt="Instagram"></a>
          <a href="https://www.tiktok.com/@manna.app"><img src="../public/images/tt.png" alt="TikTok"></a>
        </div>
      </div>
    </div>
  </header>

  <!-- Lesson Content -->
  <section class="lesson-content-section">
    <div class="container lesson-container">
      <!-- Left Side: Lesson Content -->
      <div class="lesson-content">
        <div class="lesson-progress">
          <div class="progress-bar">
            <div class="progress-fill" style="width: 0%"></div>
          </div>
          <div class="progress-text">0% Complete</div>
        </div>

        <!-- Section 1 -->
        <div class="lesson-section" id="section1">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>God Calls Abram to Leave His Homeland</h2>
              <div class="lesson-reference" data-verses="1-3">Genesis 12:1-3</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "Now the LORD had said unto Abram, Get thee out of thy country, and from thy kindred, and from thy father's house, unto a land that I will shew thee."
                  <cite>Genesis 12:1</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>God commands Abram to leave his country and family for a new land</li>
                  <li>God promises to bless Abram and make him a great nation</li>
                  <li>All families on earth will be blessed through Abram</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>God speaks to Abram, instructing him to leave his homeland and go to a place He will show him. Abram is promised great blessings, including becoming the father of a mighty nation. This call marks the beginning of God's special relationship with Abram, setting the stage for future generations. The promise extends beyond Abram, as God declares that all people on earth will be blessed through him. This shows God's plan to use one man's faithfulness to impact the entire world.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="next-section-btn" data-next="section2">Continue</button>
          </div>
        </div>

        <!-- Section 2 -->
        <div class="lesson-section hidden" id="section2">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>Abram's Journey to Canaan</h2>
              <div class="lesson-reference" data-verses="4-9">Genesis 12:4-9</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "So Abram departed, as the LORD had spoken unto him; and Lot went with him: and Abram was seventy and five years old when he departed out of Haran."
                  <cite>Genesis 12:4</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>Abram obeys God and travels with his family to Canaan</li>
                  <li>God appears to Abram and reaffirms His promise of the land</li>
                  <li>Abram builds altars to worship God along the way</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>Abram follows God's command, taking his wife Sarai and nephew Lot to the land of Canaan. When they arrive, God appears to Abram and assures him that this land will belong to his descendants. Abram responds by building altars to honor God, showing his gratitude and faith. His journey through the land demonstrates his trust in God's promises, even though he doesn't yet see how they will come true. This section highlights the importance of obedience and worship in Abram's life.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section1">Previous</button>
            <button class="next-section-btn" data-next="section3">Continue</button>
          </div>
        </div>

        <!-- Section 3 -->
        <div class="lesson-section hidden" id="section3">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>Abram in Egypt and His Deception</h2>
              <div class="lesson-reference" data-verses="10-20">Genesis 12:10-20</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "And there was a famine in the land: and Abram went down into Egypt to sojourn there; for the famine was grievous in the land."
                  <cite>Genesis 12:10</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>A famine forces Abram to go to Egypt for survival</li>
                  <li>Abram lies about Sarai being his sister to protect himself</li>
                  <li>God intervenes to protect Sarai, and Pharaoh sends them away</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>When a famine strikes, Abram and his family travel to Egypt for food. Fearing for his life, Abram tells Sarai to pretend she is his sister, leading Pharaoh to take her into his household. God protects Sarai by sending plagues on Pharaoh's house, revealing the truth. Pharaoh confronts Abram and sends them away unharmed. This story shows Abram's human weakness but also God's faithfulness in protecting His plan despite Abram's mistakes.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section2">Previous</button>
            <button class="next-section-btn" data-next="quiz">Test My Mastery</button>
          </div>
        </div>

        <!-- Quiz Section -->
        <div class="lesson-section hidden" id="quiz">
          <div class="lesson-card quiz-card">
            <div class="lesson-card-header">
              <h2>Level Up Test</h2>
              <div class="lesson-reference" data-verses="1-20">Genesis 12</div>
            </div>
            <div class="lesson-card-body">
              <div class="quiz-container">
                <div class="quiz-progress">
                  <span id="quiz-progress-text">Question 1 of 3</span>
                  <div class="quiz-progress-bar">
                    <div class="quiz-progress-fill" style="width: 33%"></div>
                  </div>
                </div>
                
                <form id="quiz-form">
                  <!-- Question 1 -->
                  <div class="quiz-question" id="question1">
                    <h3>1. What did God promise Abram when He called him?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q1a" name="q1" value="A">
                        <label for="q1a">A. To make him a great nation</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1b" name="q1" value="B">
                        <label for="q1b">B. To give him immediate wealth</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1c" name="q1" value="C">
                        <label for="q1c">C. To make him a king</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1d" name="q1" value="D">
                        <label for="q1d">D. To protect him from all harm</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 12:2</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="submit-question-btn" data-question="1" data-verses="2">Submit Answer</button>
                      </div>
                    </div>
                  </div>

                  <!-- Question 2 -->
                  <div class="quiz-question hidden" id="question2">
                    <h3>2. Why did Abram build altars in Canaan?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q2a" name="q2" value="A">
                        <label for="q2a">A. To mark his territory</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2b" name="q2" value="B">
                        <label for="q2b">B. To worship God</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2c" name="q2" value="C">
                        <label for="q2c">C. To honor local gods</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2d" name="q2" value="D">
                        <label for="q2d">D. To remember his journey</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 12:7-8</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="prev-question-btn" data-prev="1">Previous</button>
                        <button type="button" class="submit-question-btn" data-question="2" data-verses="7-8">Submit Answer</button>
                      </div>
                    </div>
                  </div>

                  <!-- Question 3 -->
                  <div class="quiz-question hidden" id="question3">
                    <h3>3. What happened when Abram lied about Sarai in Egypt?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q3a" name="q3" value="A">
                        <label for="q3a">A. Pharaoh rewarded Abram</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3b" name="q3" value="B">
                        <label for="q3b">B. God sent plagues on Pharaoh's house</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3c" name="q3" value="C">
                        <label for="q3c">C. Sarai stayed in Egypt forever</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3d" name="q3" value="D">
                        <label for="q3d">D. Abram was punished by God</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 12:17</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="prev-question-btn" data-prev="2">Previous</button>
                        <button type="button" class="submit-question-btn" data-question="3" data-verses="17">Submit Answer</button>
                      </div>
                    </div>
                  </div>
                </form>

                <div id="quiz-results" class="hidden">
                  <h3>Your Results</h3>
                  <p id="quiz-score"></p>
                  <div id="quiz-feedback"></div>
                  <div class="quiz-result-buttons">
                    <button id="retry-quiz-btn">Try Again</button>
                    <button id="complete-lesson-btn">Complete Lesson</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section3">Previous</button>
          </div>
        </div>

        <!-- Completion Message (Hidden initially) -->
        <div class="lesson-completion hidden" id="completion">
          <div class="completion-card">
            <div class="completion-header">
              <div class="completion-icon">✓</div>
              <h2>Lesson Complete!</h2>
            </div>
            <div class="completion-content">
              <p class="completion-message">Congratulations on completing Genesis 12. You've learned about God's call to Abram and his journey to Canaan.</p>
              
              <div class="app-promotion">
                <p class="app-promotion-text">Download the Manna App to unlock more free content.</p>
                <ul class="app-features-list">
                  <li>More audio courses, Prayer, and Devotional content for Free</li>
                  <li>Progress tracking, streak rewards, and grow closer to God</li>
                  <li>Get answers to any Bible-related questions</li>
                </ul>
                <a href="/download" class="cta-btn">Download Manna Today</a>
              </div>
              
              <div class="completion-buttons">
                <a href="/bible-lessons" class="lesson-btn secondary-btn">Back to Lessons</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Side: Bible Text -->
      <div class="bible-text">
        <div class="bible-header">
          <h2>Genesis 12</h2>
          <div class="bible-controls">
            <button id="increase-font">A+</button>
            <button id="decrease-font">A-</button>
          </div>
        </div>
        <div class="bible-content">
          <p><sup>1</sup> Now the LORD had said unto Abram, Get thee out of thy country, and from thy kindred, and from thy father's house, unto a land that I will shew thee:</p>
          <p><sup>2</sup> And I will make of thee a great nation, and I will bless thee, and make thy name great; and thou shalt be a blessing:</p>
          <p><sup>3</sup> And I will bless them that bless thee, and curse him that curseth thee: and in thee shall all families of the earth be blessed.</p>
          <p><sup>4</sup> So Abram departed, as the LORD had spoken unto him; and Lot went with him: and Abram was seventy and five years old when he departed out of Haran.</p>
          <p><sup>5</sup> And Abram took Sarai his wife, and Lot his brother's son, and all their substance that they had gathered, and the souls that they had gotten in Haran; and they went forth to go into the land of Canaan; and into the land of Canaan they came.</p>
          <p><sup>6</sup> And Abram passed through the land unto the place of Sichem, unto the plain of Moreh. And the Canaanite was then in the land.</p>
          <p><sup>7</sup> And the LORD appeared unto Abram, and said, Unto thy seed will I give this land: and there builded he an altar unto the LORD, who appeared unto him.</p>
          <p><sup>8</sup> And he removed from thence unto a mountain on the east of Bethel, and pitched his tent, having Bethel on the west, and Hai on the east: and there he builded an altar unto the LORD, and called upon the name of the LORD.</p>
          <p><sup>9</sup> And Abram journeyed, going on still toward the south.</p>
          <p><sup>10</sup> And there was a famine in the land: and Abram went down into Egypt to sojourn there; for the famine was grievous in the land.</p>
          <p><sup>11</sup> And it came to pass, when he was come near to enter into Egypt, that he said unto Sarai his wife, Behold now, I know that thou art a fair woman to look upon:</p>
          <p><sup>12</sup> Therefore it shall come to pass, when the Egyptians shall see thee, that they shall say, This is his wife: and they will kill me, but they will save thee alive.</p>
          <p><sup>13</sup> Say, I pray thee, thou art my sister: that it may be well with me for thy sake; and my soul shall live because of thee.</p>
          <p><sup>14</sup> And it came to pass, that, when Abram was come into Egypt, the Egyptians beheld the woman that she was very fair.</p>
          <p><sup>15</sup> The princes also of Pharaoh saw her, and commended her before Pharaoh: and the woman was taken into Pharaoh's house.</p>
          <p><sup>16</sup> And he entreated Abram well for her sake: and he had sheep, and oxen, and he asses, and menservants, and maidservants, and she asses, and camels.</p>
          <p><sup>17</sup> And the LORD plagued Pharaoh and his house with great plagues because of Sarai Abram's wife.</p>
          <p><sup>18</sup> And Pharaoh called Abram and said, What is this that thou hast done unto me? why didst thou not tell me that she was thy wife?</p>
          <p><sup>19</sup> Why saidst thou, She is my sister? so I might have taken her to me to wife: now therefore behold thy wife, take her, and go thy way.</p>
          <p><sup>20</sup> And Pharaoh commanded his men concerning him: and they sent him away, and his wife, and all that he had.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-column">
          <h4>Links</h4>
          <div class="social-links">
            <a href="https://discord.gg/NbQVtWeNMa"><img src="../public/images/discard.png" alt="Discord"></a>
            <a href="https://www.instagram.com/the_manna_app"><img src="../public/images/ins.png" alt="Instagram"></a>
            <a href="https://www.tiktok.com/@manna.app"><img src="../public/images/tt.png" alt="TikTok"></a>
          </div>
        </div>
        <div class="footer-column">
          <h4>Contact Us</h4>
          <p><a href="mailto:support@themanna.app">support@themanna.app</a></p>
        </div>
        <div class="footer-column">
          <h4>Legal</h4>
          <div class="legal">
            <a href="https://s.femometer.com/html_template/3027.html">Privacy Policy</a>
            <a href="https://s.femometer.com/html_template/3028.html">Terms of Service</a>
          </div>
        </div>
      </div>
      <div class="copyright">
        <p>&copy; 2025 Baymed Limited. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Navigation between sections
      const sections = document.querySelectorAll('.lesson-section');
      const progressBar = document.querySelector('.progress-fill');
      const progressText = document.querySelector('.progress-text');
      const bibleVerses = document.querySelectorAll('.bible-content p');
      let currentSectionIndex = 0;
      const totalSections = sections.length - 1; // Excluding quiz section
      
      // 高亮并滚动到指定的经文
      function highlightVerses(verseRange) {
        // 移除之前的高亮
        bibleVerses.forEach(verse => {
          verse.classList.remove('highlighted');
        });
        
        if (verseRange) {
          const [start, end] = verseRange.split('-').map(v => parseInt(v));
          const endVerse = end || start;
          
          // 添加高亮到引用的经文
          for (let i = start - 1; i < endVerse; i++) {
            if (bibleVerses[i]) {
              bibleVerses[i].classList.add('highlighted');
              
              // 滚动到第一个高亮的经文
              if (i === start - 1) {
                bibleVerses[i].scrollIntoView({
                  behavior: 'smooth',
                  block: 'center'
                });
              }
            }
          }
        }
      }
      
      // Update progress
      function updateProgress() {
        if (currentSectionIndex < totalSections) {
          const progress = Math.round((currentSectionIndex / totalSections) * 100);
          progressBar.style.width = `${progress}%`;
          progressText.textContent = `${progress}% Complete`;
        }
      }
      
      // Show section
      function showSection(sectionId) {
        sections.forEach(section => {
          section.classList.add('hidden');
        });
        
        const currentSection = document.getElementById(sectionId);
        currentSection.classList.remove('hidden');
        
        // 更新当前部分索引
        for (let i = 0; i < sections.length; i++) {
          if (sections[i].id === sectionId) {
            currentSectionIndex = i;
            break;
          }
        }
        
        // 自动高亮相关经文
        const reference = currentSection.querySelector('.lesson-reference');
        if (reference) {
          const verseRange = reference.getAttribute('data-verses');
          highlightVerses(verseRange);
        }
        
        updateProgress();

        // 如果是测试模块，立即隐藏所有 Previous 按钮
        if (sectionId === 'quiz') {
          // 隐藏底部导航中的 Previous 按钮
          document.querySelector('#quiz .lesson-navigation-buttons .prev-section-btn').style.display = 'none';
          // 隐藏问题中的 Previous 按钮
          document.querySelectorAll('.prev-question-btn').forEach(button => {
            button.style.display = 'none';
          });
        }
        
        // 滚动到部分顶部
        window.scrollTo({
          top: document.querySelector('.lesson-content').offsetTop - 100,
          behavior: 'smooth'
        });
      }
      
      // Next section buttons
      document.querySelectorAll('.next-section-btn').forEach(button => {
        button.addEventListener('click', function() {
          const nextSectionId = this.getAttribute('data-next');
          showSection(nextSectionId);
        });
      });
      
      // Previous section buttons
      document.querySelectorAll('.prev-section-btn').forEach(button => {
        button.addEventListener('click', function() {
          const prevSectionId = this.getAttribute('data-prev');
          showSection(prevSectionId);
        });
      });
      
    
      const initialReference = document.querySelector('#section1 .lesson-reference');
      if (initialReference) {
        const verseRange = initialReference.getAttribute('data-verses');
        highlightVerses(verseRange);
      }
      
      // Quiz functionality
      const quizForm = document.getElementById('quiz-form');
      const quizQuestions = document.querySelectorAll('.quiz-question');
      const quizResults = document.getElementById('quiz-results');
      const quizScore = document.getElementById('quiz-score');
      const quizFeedback = document.getElementById('quiz-feedback');
      const retryQuizBtn = document.getElementById('retry-quiz-btn');
      const completeLessonBtn = document.getElementById('complete-lesson-btn');
      const quizProgressText = document.getElementById('quiz-progress-text');
      const quizProgressFill = document.querySelector('.quiz-progress-fill');
      const bibleTextSection = document.querySelector('.bible-text');
      let currentQuestionIndex = 0;
      let userAnswers = {};
      let questionSubmitted = {};

      // 初始化时隐藏圣经文本
      function toggleBibleText(show) {
        if (show) {
          bibleTextSection.style.display = 'block';
        } else {
          bibleTextSection.style.display = 'none';
        }
      }

      // 显示指定问题
      function showQuestion(index) {
        quizQuestions.forEach((question, i) => {
          if (i === index) {
            question.classList.remove('hidden');
          } else {
            question.classList.add('hidden');
          }
        });
        
        // 更新进度条
        currentQuestionIndex = index;
        quizProgressText.textContent = `Question ${index + 1} of ${quizQuestions.length}`;
        quizProgressFill.style.width = `${((index + 1) / quizQuestions.length) * 100}%`;
        
        // 如果问题已提交，显示圣经文本，否则隐藏
        toggleBibleText(questionSubmitted[index + 1]);
      }

      // 提交问题答案
      function submitQuestion(questionNumber, verseRange) {
        const questionIndex = questionNumber - 1;
        const selectedOption = document.querySelector(`input[name="q${questionNumber}"]:checked`);
        const feedbackElement = document.querySelector(`#question${questionNumber} .quiz-feedback`);
        const hintElement = document.querySelector(`#question${questionNumber} .quiz-hint`);
        const submitButton = document.querySelector(`#question${questionNumber} .submit-question-btn`);
        const nextButton = document.createElement('button');
        nextButton.type = 'button';
        nextButton.className = 'next-question-btn';
        
        const answers = {
          q1: 'A',
          q2: 'B',
          q3: 'B'
        };
        
        if (!selectedOption) {
          feedbackElement.innerHTML = '<p class="incorrect">Please select an answer.</p>';
          feedbackElement.classList.remove('hidden');
          return;
        }
        
        // 记录用户答案
        userAnswers[`q${questionNumber}`] = selectedOption.value;
        questionSubmitted[questionNumber] = true;
        
        // 显示提示和反馈
        hintElement.classList.remove('hidden');
        
        // 禁用选项和提交按钮
        document.querySelectorAll(`#question${questionNumber} input[type="radio"]`).forEach(input => {
          input.disabled = true;
        });
        submitButton.disabled = true;
        submitButton.style.display = 'none'; // 隐藏提交按钮
        
        // 显示反馈
        if (selectedOption.value === answers[`q${questionNumber}`]) {
          feedbackElement.innerHTML = '<p class="correct">Correct!</p>';
        } else {
          feedbackElement.innerHTML = `<p class="incorrect">Incorrect. The correct answer is ${answers[`q${questionNumber}`]}.</p>`;
        }
        feedbackElement.classList.remove('hidden');
        
        // 显示圣经文本并高亮相关经文
        toggleBibleText(true);
        highlightVerses(verseRange);
        
        // 如果不是最后一个问题，添加下一题按钮
        if (questionNumber < quizQuestions.length) {
          nextButton.textContent = 'Next Question';
          nextButton.setAttribute('data-next', questionNumber + 1);
          nextButton.addEventListener('click', function() {
            showQuestion(parseInt(this.getAttribute('data-next')) - 1);
          });
          submitButton.parentNode.appendChild(nextButton);
        } else {
          // 如果是最后一个问题，添加查看结果按钮
          nextButton.textContent = 'View Results';
          nextButton.addEventListener('click', showResults);
          submitButton.parentNode.appendChild(nextButton);
        }
      }

      // 显示测验结果
      function showResults() {
        const answers = {
          q1: 'A',
          q2: 'B',
          q3: 'B'
        };
        
        let score = 0;
        let feedback = '';
        
        // 检查答案
        for (const question in answers) {
          if (userAnswers[question] === answers[question]) {
            score++;
            feedback += `<p class="correct">Question ${question.substring(1)}: Correct!</p>`;
          } else {
            feedback += `<p class="incorrect">Question ${question.substring(1)}: Incorrect. The correct answer is ${answers[question]}.</p>`;
          }
        }
        
        // 显示结果
        quizScore.textContent = `You scored ${score} out of 3`;
        quizFeedback.innerHTML = feedback;
        
        // 隐藏问题，显示结果
        quizQuestions.forEach(question => {
          question.classList.add('hidden');
        });
        quizResults.classList.remove('hidden');
      }

      // 重置测验
      retryQuizBtn.addEventListener('click', function() {
        quizForm.reset();
        quizResults.classList.add('hidden');
        userAnswers = {};
        questionSubmitted = {};
        
        // 重置所有问题状态
        document.querySelectorAll('.quiz-hint').forEach(element => {
          element.classList.add('hidden');
        });
        
        document.querySelectorAll('.quiz-feedback').forEach(element => {
          element.classList.add('hidden');
          element.innerHTML = ''; // 清空反馈内容
        });
        
        document.querySelectorAll('.quiz-question input[type="radio"]').forEach(input => {
          input.disabled = false;
        });
        
        document.querySelectorAll('.submit-question-btn').forEach(button => {
          button.disabled = false;
          button.style.display = '';
        });
        
        document.querySelectorAll('.next-question-btn').forEach(button => {
          button.remove();
        });
        
        // 显示第一个问题
        showQuestion(0);
        toggleBibleText(false);
      });

      // 完成课程
      completeLessonBtn.addEventListener('click', function() {
        document.getElementById('quiz').classList.add('hidden');
        document.getElementById('completion').classList.remove('hidden');
        progressBar.style.width = '100%';
        progressText.textContent = '100% Complete';
        // 隐藏圣经文本
        toggleBibleText(false);
      });

      // 上一题按钮
      document.querySelectorAll('.prev-question-btn').forEach(button => {
        button.addEventListener('click', function() {
          const prevQuestionIndex = parseInt(this.getAttribute('data-prev')) - 1;
          showQuestion(prevQuestionIndex);
        });
      });

      // 提交答案按钮
      document.querySelectorAll('.submit-question-btn').forEach(button => {
        button.addEventListener('click', function() {
          const questionNumber = parseInt(this.getAttribute('data-question'));
          const verseRange = this.getAttribute('data-verses');
          submitQuestion(questionNumber, verseRange);
        });
      });

      // 初始化测验
      function initQuiz() {
        // 确保只显示第一个问题，其他都隐藏
        quizQuestions.forEach((question, i) => {
          if (i === 0) {
            question.classList.remove('hidden');
          } else {
            question.classList.add('hidden');
          }
        });
        
        // 隐藏所有提示
        document.querySelectorAll('.quiz-hint').forEach(hint => {
          hint.classList.add('hidden');
        });
        
        // 隐藏结果部分
        document.getElementById('quiz-results').classList.add('hidden');
        
        // 隐藏底部导航中的 Previous 按钮
        document.querySelector('#quiz .lesson-navigation-buttons .prev-section-btn').style.display = 'none';
        
        // 隐藏所有问题中的 Previous 按钮
        document.querySelectorAll('.prev-question-btn').forEach(button => {
          button.style.display = 'none';
        });
        
        toggleBibleText(false);
      }

      // 当进入测验部分时初始化
      document.querySelector('[data-next="quiz"]').addEventListener('click', function() {
        setTimeout(initQuiz, 100); // 给DOM更新一点时间
      });
      
      // Bible text font size controls
      const bibleContent = document.querySelector('.bible-content');
      let fontSize = 16; // Default font size
      
      document.getElementById('increase-font').addEventListener('click', function() {
        if (fontSize < 24) {
          fontSize += 2;
          bibleContent.style.fontSize = `${fontSize}px`;
        }
      });
      
      document.getElementById('decrease-font').addEventListener('click', function() {
        if (fontSize > 12) {
          fontSize -= 2;
          bibleContent.style.fontSize = `${fontSize}px`;
        }
      });
    });
  </script>
</body>
</html>
