<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Genesis 6: Noah and the Flood - Manna</title>
<meta name="description" content="Bible Lessons on Genesis 6 KJV: genesis 6 explained verse by verse.">
<link rel="stylesheet" href="../styles.css">
<link rel="stylesheet" href="../css/lesson-content.css">
<link rel="icon" href="../public/images/icon.png">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DF5ZGFNKTB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DF5ZGFNKTB');
</script>
</head>

<body>
<!-- Header -->
<header>
  <div class="container">
    <div class="header-content">
      <div class="logo">
        <a href="/">
          <img src="../public/images/icon.png" alt="Manna Icon">
          <span>Manna</span>
        </a>
      </div>
      <nav>
        <ul>
          <li><a href="/bible-lessons">Lessons</a></li>
          <li><a href="/prayers">Prayers</a></li>
          <li><a href="/resources">Resources</a></li>
          <li><a href="/#download">Download</a></li>
        </ul>
      </nav>
      <div class="social-header">
        <a href="https://discord.gg/NbQVtWeNMa"><img src="../public/images/discard.png" alt="Discord"></a>
        <a href="https://www.instagram.com/the_manna_app"><img src="../public/images/ins.png" alt="Instagram"></a>
        <a href="https://www.tiktok.com/@manna.app"><img src="../public/images/tt.png" alt="TikTok"></a>
      </div>
    </div>
  </div>
</header>

<!-- Lesson Content -->
<section class="lesson-content-section">
  <div class="container lesson-container">
    <!-- Left Side: Lesson Content -->
    <div class="lesson-content">
      <div class="lesson-progress">
        <div class="progress-bar">
          <div class="progress-fill" style="width: 0%"></div>
        </div>
        <div class="progress-text">0% Complete</div>
      </div>

      <!-- Section 1 -->
      <div class="lesson-section" id="section1">
        <div class="lesson-card">
          <div class="lesson-card-header">
            <h2>The Wickedness of Humanity</h2>
            <div class="lesson-reference" data-verses="1-5">Genesis 6:1-5</div>
          </div>
          <div class="lesson-card-body">
            <div class="key-verse">
              <blockquote>
                "And God saw that the wickedness of man was great in the earth, and that every imagination of the thoughts of his heart was only evil continually."
                <cite>Genesis 6:5</cite>
              </blockquote>
            </div>
            <div class="key-points">
              <h3>Key Points:</h3>
              <ul>
                <li>Humanity becomes increasingly corrupt and violent</li>
                <li>God observes the widespread evil in human hearts</li>
                <li>God decides to limit human lifespan to 120 years</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="lesson-detail">
          <p>The first section describes a time when humanity had become deeply corrupt. People were doing terrible things, and their thoughts were constantly focused on evil. God saw how bad things had gotten and decided that humans would no longer live as long as they had been. This shows that God cares about justice and will not ignore wrongdoing forever. The situation had gotten so bad that God needed to take action.</p>
        </div>
        <div class="lesson-navigation-buttons">
          <button class="next-section-btn" data-next="section2">Continue</button>
        </div>
      </div>

      <!-- Section 2 -->
      <div class="lesson-section hidden" id="section2">
        <div class="lesson-card">
          <div class="lesson-card-header">
            <h2>Noah Finds Favor with God</h2>
            <div class="lesson-reference" data-verses="6-10">Genesis 6:6-10</div>
          </div>
          <div class="lesson-card-body">
            <div class="key-verse">
              <blockquote>
                "But Noah found grace in the eyes of the LORD."
                <cite>Genesis 6:8</cite>
              </blockquote>
            </div>
            <div class="key-points">
              <h3>Key Points:</h3>
              <ul>
                <li>God is grieved by human wickedness and regrets creating them</li>
                <li>Noah stands out as a righteous and blameless man</li>
                <li>God chooses Noah to preserve life through the coming judgment</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="lesson-detail">
          <p>In the next part, we see that God was deeply saddened by the evil in the world. He regretted making humans because of their wickedness. However, there was one man named Noah who was different. He lived in a way that pleased God, avoiding the corruption around him. Because of Noah's faithfulness, God chose him for a special mission. This teaches us that even in dark times, individuals can make a difference by living rightly.</p>
        </div>
        <div class="lesson-navigation-buttons">
          <button class="prev-section-btn" data-prev="section1">Previous</button>
          <button class="next-section-btn" data-next="section3">Continue</button>
        </div>
      </div>

      <!-- Section 3 -->
      <div class="lesson-section hidden" id="section3">
        <div class="lesson-card">
          <div class="lesson-card-header">
            <h2>God's Plan to Destroy the Earth</h2>
            <div class="lesson-reference" data-verses="11-22">Genesis 6:11-22</div>
          </div>
          <div class="lesson-card-body">
            <div class="key-verse">
              <blockquote>
                "And God said unto Noah, The end of all flesh is come before me; for the earth is filled with violence through them; and, behold, I will destroy them with the earth."
                <cite>Genesis 6:13</cite>
              </blockquote>
            </div>
            <div class="key-points">
              <h3>Key Points:</h3>
              <ul>
                <li>God announces His decision to destroy all living creatures</li>
                <li>Noah is instructed to build an ark to save his family and animals</li>
                <li>God establishes a covenant with Noah for future preservation</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="lesson-detail">
          <p>The final section explains God's plan to cleanse the earth with a great flood. He told Noah exactly how to build a huge boat to save his family and pairs of every animal. Noah obeyed God's instructions without question, showing great trust. This story highlights that God provides a way of salvation for those who follow Him, even when judgment is coming. It also shows that obedience to God brings protection and hope.</p>
        </div>
        <div class="lesson-navigation-buttons">
          <button class="prev-section-btn" data-prev="section2">Previous</button>
          <button class="next-section-btn" data-next="quiz">Test My Mastery</button>
        </div>
      </div>

      <!-- Quiz Section -->
      <div class="lesson-section hidden" id="quiz">
        <div class="lesson-card quiz-card">
          <div class="lesson-card-header">
            <h2>Level Up Test</h2>
            <div class="lesson-reference" data-verses="1-22">Genesis 6</div>
          </div>
          <div class="lesson-card-body">
            <div class="quiz-container">
              <div class="quiz-progress">
                <span id="quiz-progress-text">Question 1 of 3</span>
                <div class="quiz-progress-bar">
                  <div class="quiz-progress-fill" style="width: 33%"></div>
                </div>
              </div>
              
              <form id="quiz-form">
                <!-- Question 1 -->
                <div class="quiz-question" id="question1">
                  <h3>1. What did God observe about humanity's thoughts?</h3>
                  <div class="quiz-options">
                    <div class="quiz-option">
                      <input type="radio" id="q1a" name="q1" value="A">
                      <label for="q1a">A. They were constantly good</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q1b" name="q1" value="B">
                      <label for="q1b">B. They were focused on evil</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q1c" name="q1" value="C">
                      <label for="q1c">C. They were indifferent</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q1d" name="q1" value="D">
                      <label for="q1d">D. They were changing daily</label>
                    </div>
                  </div>
                  <div class="quiz-hint hidden">
                    <p><strong>Hint:</strong> Genesis 6:5</p>
                  </div>
                  <div class="quiz-feedback hidden"></div>
                  <div class="quiz-controls">
                    <div class="quiz-buttons-center">
                      <button type="button" class="submit-question-btn" data-question="1" data-verses="5">Submit Answer</button>
                    </div>
                  </div>
                </div>

                <!-- Question 2 -->
                <div class="quiz-question hidden" id="question2">
                  <h3>2. Why was Noah chosen by God?</h3>
                  <div class="quiz-options">
                    <div class="quiz-option">
                      <input type="radio" id="q2a" name="q2" value="A">
                      <label for="q2a">A. He was the strongest man</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q2b" name="q2" value="B">
                      <label for="q2b">B. He was righteous and blameless</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q2c" name="q2" value="C">
                      <label for="q2c">C. He was the oldest living</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q2d" name="q2" value="D">
                      <label for="q2d">D. He was the wealthiest</label>
                    </div>
                  </div>
                  <div class="quiz-hint hidden">
                    <p><strong>Hint:</strong> Genesis 6:8-9</p>
                  </div>
                  <div class="quiz-feedback hidden"></div>
                  <div class="quiz-controls">
                    <div class="quiz-buttons-center">
                      <button type="button" class="prev-question-btn" data-prev="1">Previous</button>
                      <button type="button" class="submit-question-btn" data-question="2" data-verses="8-9">Submit Answer</button>
                    </div>
                  </div>
                </div>

                <!-- Question 3 -->
                <div class="quiz-question hidden" id="question3">
                  <h3>3. What was Noah instructed to build?</h3>
                  <div class="quiz-options">
                    <div class="quiz-option">
                      <input type="radio" id="q3a" name="q3" value="A">
                      <label for="q3a">A. A temple</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q3b" name="q3" value="B">
                      <label for="q3b">B. A city wall</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q3c" name="q3" value="C">
                      <label for="q3c">C. An ark</label>
                    </div>
                    <div class="quiz-option">
                      <input type="radio" id="q3d" name="q3" value="D">
                      <label for="q3d">D. A tower</label>
                    </div>
                  </div>
                  <div class="quiz-hint hidden">
                    <p><strong>Hint:</strong> Genesis 6:14</p>
                  </div>
                  <div class="quiz-feedback hidden"></div>
                  <div class="quiz-controls">
                    <div class="quiz-buttons-center">
                      <button type="button" class="prev-question-btn" data-prev="2">Previous</button>
                      <button type="button" class="submit-question-btn" data-question="3" data-verses="14">Submit Answer</button>
                    </div>
                  </div>
                </div>
              </form>

              <div id="quiz-results" class="hidden">
                <h3>Your Results</h3>
                <p id="quiz-score"></p>
                <div id="quiz-feedback"></div>
                <div class="quiz-result-buttons">
                  <button id="retry-quiz-btn">Try Again</button>
                  <button id="complete-lesson-btn">Complete Lesson</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="lesson-navigation-buttons">
          <button class="prev-section-btn" data-prev="section3">Previous</button>
        </div>
      </div>

      <!-- Completion Message (Hidden initially) -->
      <div class="lesson-completion hidden" id="completion">
        <div class="completion-card">
          <div class="completion-header">
            <div class="completion-icon">✓</div>
            <h2>Lesson Complete!</h2>
          </div>
          <div class="completion-content">
            <p class="completion-message">Congratulations on completing Genesis 6. You've learned about the wickedness of humanity and God's plan for Noah and the ark.</p>
            
            <div class="app-promotion">
              <p class="app-promotion-text">Download the Manna App to unlock more free content.</p>
              <ul class="app-features-list">
                <li>More audio courses, Prayer, and Devotional content for Free</li>
                <li>Progress tracking, streak rewards, and grow closer to God</li>
                <li>Get answers to any Bible-related questions</li>
              </ul>
              <div class="download-options">
                <div class="qr-code">
                  <img src="../public/images/qrcode.png" alt="QR Code to download Manna App">
                </div>
                <div class="app-store-links">
                  <a href="https://apps.apple.com/us/app/manna-bible-study-prayer/id1669523799" class="app-store-link">
                    <img src="../public/images/download.png" alt="Download on App Store">
                  </a>
                </div>
              </div>
            </div>
            
            <div class="completion-buttons">
              <a href="/bible-lessons/genesis7" class="lesson-btn primary-btn">Next Lesson: Genesis 7</a>
              <a href="/bible-lessons" class="lesson-btn secondary-btn">Back to Lessons</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Side: Bible Text -->
    <div class="bible-text">
      <div class="bible-header">
        <h2>Genesis 6</h2>
        <div class="bible-controls">
          <button id="increase-font">A+</button>
          <button id="decrease-font">A-</button>
        </div>
      </div>
      <div class="bible-content">
        <p><sup>1</sup> And it came to pass, when men began to multiply on the face of the earth, and daughters were born unto them,</p>
        <p><sup>2</sup> That the sons of God saw the daughters of men that they were fair; and they took them wives of all which they chose.</p>
        <p><sup>3</sup> And the LORD said, My spirit shall not always strive with man, for that he also is flesh: yet his days shall be an hundred and twenty years.</p>
        <p><sup>4</sup> There were giants in the earth in those days; and also after that, when the sons of God came in unto the daughters of men, and they bare children to them, the same became mighty men which were of old, men of renown.</p>
        <p><sup>5</sup> And God saw that the wickedness of man was great in the earth, and that every imagination of the thoughts of his heart was only evil continually.</p>
        <p><sup>6</sup> And it repented the LORD that he had made man on the earth, and it grieved him at his heart.</p>
        <p><sup>7</sup> And the LORD said, I will destroy man whom I have created from the face of the earth; both man, and beast, and the creeping thing, and the fowls of the air; for it repenteth me that I have made them.</p>
        <p><sup>8</sup> But Noah found grace in the eyes of the LORD.</p>
        <p><sup>9</sup> These are the generations of Noah: Noah was a just man and perfect in his generations, and Noah walked with God.</p>
        <p><sup>10</sup> And Noah begat three sons, Shem, Ham, and Japheth.</p>
        <p><sup>11</sup> The earth also was corrupt before God, and the earth was filled with violence.</p>
        <p><sup>12</sup> And God looked upon the earth, and, behold, it was corrupt; for all flesh had corrupted his way upon the earth.</p>
        <p><sup>13</sup> And God said unto Noah, The end of all flesh is come before me; for the earth is filled with violence through them; and, behold, I will destroy them with the earth.</p>
        <p><sup>14</sup> Make thee an ark of gopher wood; rooms shalt thou make in the ark, and shalt pitch it within and without with pitch.</p>
        <p><sup>15</sup> And this is the fashion which thou shalt make it of: The length of the ark shall be three hundred cubits, the breadth of it fifty cubits, and the height of it thirty cubits.</p>
        <p><sup>16</sup> A window shalt thou make to the ark, and in a cubit shalt thou finish it above; and the door of the ark shalt thou set in the side thereof; with lower, second, and third stories shalt thou make it.</p>
        <p><sup>17</sup> And, behold, I, even I, do bring a flood of waters upon the earth, to destroy all flesh, wherein is the breath of life, from under heaven; and every thing that is in the earth shall die.</p>
        <p><sup>18</sup> But with thee will I establish my covenant; and thou shalt come into the ark, thou, and thy sons, and thy wife, and thy sons' wives with thee.</p>
        <p><sup>19</sup> And of every living thing of all flesh, two of every sort shalt thou bring into the ark, to keep them alive with thee; they shall be male and female.</p>
        <p><sup>20</sup> Of fowls after their kind, and of cattle after their kind, of every creeping thing of the earth after his kind, two of every sort shall come unto thee, to keep them alive.</p>
        <p><sup>21</sup> And take thou unto thee of all food that is eaten, and thou shalt gather it to thee; and it shall be for food for thee, and for them.</p>
        <p><sup>22</sup> Thus did Noah; according to all that God commanded him, so did he.</p>
      </div>
    </div>
  </div>
</section>

<!-- Footer -->
<footer>
  <div class="container">
    <div class="footer-content">
      <div class="footer-column">
        <h4>Links</h4>
        <div class="social-links">
          <a href="https://discord.gg/NbQVtWeNMa"><img src="../public/images/discard.png" alt="Discord"></a>
          <a href="https://www.instagram.com/the_manna_app"><img src="../public/images/ins.png" alt="Instagram"></a>
          <a href="https://www.tiktok.com/@manna.app"><img src="../public/images/tt.png" alt="TikTok"></a>
        </div>
      </div>
      <div class="footer-column">
        <h4>Contact Us</h4>
        <p><a href="mailto:support@themanna.app">support@themanna.app</a></p>
      </div>
      <div class="footer-column">
        <h4>Legal</h4>
        <div class="legal">
          <a href="https://s.femometer.com/html_template/3027.html">Privacy Policy</a>
          <a href="https://s.femometer.com/html_template/3028.html">Terms of Service</a>
        </div>
      </div>
    </div>
    <div class="copyright">
      <p>&copy; 2025 Baymed Limited. All rights reserved.</p>
    </div>
  </div>
</footer>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Navigation between sections
    const sections = document.querySelectorAll('.lesson-section');
    const progressBar = document.querySelector('.progress-fill');
    const progressText = document.querySelector('.progress-text');
    const bibleVerses = document.querySelectorAll('.bible-content p');
    let currentSectionIndex = 0;
    const totalSections = sections.length - 1; // Excluding quiz section
    
    // 高亮并滚动到指定的经文
    function highlightVerses(verseRange) {
      // 移除之前的高亮
      bibleVerses.forEach(verse => {
        verse.classList.remove('highlighted');
      });
      
      if (verseRange) {
        const [start, end] = verseRange.split('-').map(v => parseInt(v));
        const endVerse = end || start;
        
        // 添加高亮到引用的经文
        for (let i = start - 1; i < endVerse; i++) {
          if (bibleVerses[i]) {
            bibleVerses[i].classList.add('highlighted');
            
            // 滚动到第一个高亮的经文
            if (i === start - 1) {
              bibleVerses[i].scrollIntoView({
                behavior: 'smooth',
                block: 'center'
              });
            }
          }
        }
      }
    }
    
    // Update progress
    function updateProgress() {
      if (currentSectionIndex < totalSections) {
        const progress = Math.round((currentSectionIndex / totalSections) * 100);
        progressBar.style.width = `${progress}%`;
        progressText.textContent = `${progress}% Complete`;
      }
    }
    
    // Show section
    function showSection(sectionId) {
      sections.forEach(section => {
        section.classList.add('hidden');
      });
      
      const currentSection = document.getElementById(sectionId);
      currentSection.classList.remove('hidden');
      
      // 更新当前部分索引
      for (let i = 0; i < sections.length; i++) {
        if (sections[i].id === sectionId) {
          currentSectionIndex = i;
          break;
        }
      }
      
      // 自动高亮相关经文
      const reference = currentSection.querySelector('.lesson-reference');
      if (reference) {
        const verseRange = reference.getAttribute('data-verses');
        highlightVerses(verseRange);
      }
      
      updateProgress();

      // 如果是测试模块，立即隐藏所有 Previous 按钮
      if (sectionId === 'quiz') {
        // 隐藏底部导航中的 Previous 按钮
        document.querySelector('#quiz .lesson-navigation-buttons .prev-section-btn').style.display = 'none';
        // 隐藏问题中的 Previous 按钮
        document.querySelectorAll('.prev-question-btn').forEach(button => {
          button.style.display = 'none';
        });
      }
      
      // 滚动到部分顶部
      window.scrollTo({
        top: document.querySelector('.lesson-content').offsetTop - 100,
        behavior: 'smooth'
      });
    }
    
    // Next section buttons
    document.querySelectorAll('.next-section-btn').forEach(button => {
      button.addEventListener('click', function() {
        const nextSectionId = this.getAttribute('data-next');
        showSection(nextSectionId);
      });
    });
    
    // Previous section buttons
    document.querySelectorAll('.prev-section-btn').forEach(button => {
      button.addEventListener('click', function() {
        const prevSectionId = this.getAttribute('data-prev');
        showSection(prevSectionId);
      });
    });
    
    // 初始化第一部分的经文高亮
    const initialReference = document.querySelector('#section1 .lesson-reference');
    if (initialReference) {
      const verseRange = initialReference.getAttribute('data-verses');
      highlightVerses(verseRange);
    }
    
    // Quiz functionality
    const quizForm = document.getElementById('quiz-form');
    const quizQuestions = document.querySelectorAll('.quiz-question');
    const quizResults = document.getElementById('quiz-results');
    const quizScore = document.getElementById('quiz-score');
    const quizFeedback = document.getElementById('quiz-feedback');
    const retryQuizBtn = document.getElementById('retry-quiz-btn');
    const completeLessonBtn = document.getElementById('complete-lesson-btn');
    const quizProgressText = document.getElementById('quiz-progress-text');
    const quizProgressFill = document.querySelector('.quiz-progress-fill');
    const bibleTextSection = document.querySelector('.bible-text');
    let currentQuestionIndex = 0;
    let userAnswers = {};
    let questionSubmitted = {};

    // 初始化时隐藏圣经文本
    function toggleBibleText(show) {
      if (show) {
        bibleTextSection.style.display = 'block';
      } else {
        bibleTextSection.style.display = 'none';
      }
    }

    // 显示指定问题
    function showQuestion(index) {
      quizQuestions.forEach((question, i) => {
        if (i === index) {
          question.classList.remove('hidden');
        } else {
          question.classList.add('hidden');
        }
      });
      
      // 更新进度条
      currentQuestionIndex = index;
      quizProgressText.textContent = `Question ${index + 1} of ${quizQuestions.length}`;
      quizProgressFill.style.width = `${((index + 1) / quizQuestions.length) * 100}%`;
      
      // 如果问题已提交，显示圣经文本，否则隐藏
      toggleBibleText(questionSubmitted[index + 1]);
    }

    // 提交问题答案
    function submitQuestion(questionNumber, verseRange) {
      const questionIndex = questionNumber - 1;
      const selectedOption = document.querySelector(`input[name="q${questionNumber}"]:checked`);
      const feedbackElement = document.querySelector(`#question${questionNumber} .quiz-feedback`);
      const hintElement = document.querySelector(`#question${questionNumber} .quiz-hint`);
      const submitButton = document.querySelector(`#question${questionNumber} .submit-question-btn`);
      const nextButton = document.createElement('button');
      nextButton.type = 'button';
      nextButton.className = 'next-question-btn';
      
      const answers = {
        q1: 'B',
        q2: 'B',
        q3: 'C'
      };
      
      if (!selectedOption) {
        feedbackElement.innerHTML = '<p class="incorrect">Please select an answer.</p>';
        feedbackElement.classList.remove('hidden');
        return;
      }
      
      // 记录用户答案
      userAnswers[`q${questionNumber}`] = selectedOption.value;
      questionSubmitted[questionNumber] = true;
      
      // 显示提示和反馈
      hintElement.classList.remove('hidden');
      
      // 禁用选项和提交按钮
      document.querySelectorAll(`#question${questionNumber} input[type="radio"]`).forEach(input => {
        input.disabled = true;
      });
      submitButton.disabled = true;
      submitButton.style.display = 'none'; // 隐藏提交按钮
      
      // 显示反馈
      if (selectedOption.value === answers[`q${questionNumber}`]) {
        feedbackElement.innerHTML = '<p class="correct">Correct!</p>';
      } else {
        feedbackElement.innerHTML = `<p class="incorrect">Incorrect. The correct answer is ${answers[`q${questionNumber}`]}.</p>`;
      }
      feedbackElement.classList.remove('hidden');
      
      // 显示圣经文本并高亮相关经文
      toggleBibleText(true);
      highlightVerses(verseRange);
      
      // 如果不是最后一个问题，添加下一题按钮
      if (questionNumber < quizQuestions.length) {
        nextButton.textContent = 'Next Question';
        nextButton.setAttribute('data-next', questionNumber + 1);
        nextButton.addEventListener('click', function() {
          showQuestion(parseInt(this.getAttribute('data-next')) - 1);
        });
        submitButton.parentNode.appendChild(nextButton);
      } else {
        // 如果是最后一个问题，添加查看结果按钮
        nextButton.textContent = 'View Results';
        nextButton.addEventListener('click', showResults);
        submitButton.parentNode.appendChild(nextButton);
      }
    }

    // 显示测验结果
    function showResults() {
      const answers = {
        q1: 'B',
        q2: 'B',
        q3: 'C'
      };
      
      let score = 0;
      let feedback = '';
      
      // 检查答案
      for (const question in answers) {
        if (userAnswers[question] === answers[question]) {
          score++;
          feedback += `<p class="correct">Question ${question.substring(1)}: Correct!</p>`;
        } else {
          feedback += `<p class="incorrect">Question ${question.substring(1)}: Incorrect. The correct answer is ${answers[question]}.</p>`;
        }
      }
      
      // 显示结果
      quizScore.textContent = `You scored ${score} out of 3`;
      quizFeedback.innerHTML = feedback;
      
      // 隐藏问题，显示结果
      quizQuestions.forEach(question => {
        question.classList.add('hidden');
      });
      quizResults.classList.remove('hidden');
    }

    // 重置测验
    retryQuizBtn.addEventListener('click', function() {
      quizForm.reset();
      quizResults.classList.add('hidden');
      userAnswers = {};
      questionSubmitted = {};
      
      // 重置所有问题状态
      document.querySelectorAll('.quiz-hint').forEach(element => {
        element.classList.add('hidden');
      });
      
      document.querySelectorAll('.quiz-feedback').forEach(element => {
        element.classList.add('hidden');
        element.innerHTML = ''; // 清空反馈内容
      });
      
      document.querySelectorAll('.quiz-question input[type="radio"]').forEach(input => {
        input.disabled = false;
      });
      
      document.querySelectorAll('.submit-question-btn').forEach(button => {
        button.disabled = false;
        button.style.display = '';
      });
      
      document.querySelectorAll('.next-question-btn').forEach(button => {
        button.remove();
      });
      
      // 显示第一个问题
      showQuestion(0);
      toggleBibleText(false);
    });

    // 完成课程
    completeLessonBtn.addEventListener('click', function() {
      document.getElementById('quiz').classList.add('hidden');
      document.getElementById('completion').classList.remove('hidden');
      progressBar.style.width = '100%';
      progressText.textContent = '100% Complete';
      // 隐藏圣经文本
      toggleBibleText(false);
    });

    // 上一题按钮
    document.querySelectorAll('.prev-question-btn').forEach(button => {
      button.addEventListener('click', function() {
        const prevQuestionIndex = parseInt(this.getAttribute('data-prev')) - 1;
        showQuestion(prevQuestionIndex);
      });
    });

    // 提交答案按钮
    document.querySelectorAll('.submit-question-btn').forEach(button => {
      button.addEventListener('click', function() {
        const questionNumber = parseInt(this.getAttribute('data-question'));
        const verseRange = this.getAttribute('data-verses');
        submitQuestion(questionNumber, verseRange);
      });
    });

    // 初始化测验
    function initQuiz() {
      // 确保只显示第一个问题，其他都隐藏
      quizQuestions.forEach((question, i) => {
        if (i === 0) {
          question.classList.remove('hidden');
        } else {
          question.classList.add('hidden');
        }
      });
      
      // 隐藏所有提示
      document.querySelectorAll('.quiz-hint').forEach(hint => {
        hint.classList.add('hidden');
      });
      
      // 隐藏结果部分
      document.getElementById('quiz-results').classList.add('hidden');
      
      // 隐藏底部导航中的 Previous 按钮
      document.querySelector('#quiz .lesson-navigation-buttons .prev-section-btn').style.display = 'none';
      
      // 隐藏所有问题中的 Previous 按钮
      document.querySelectorAll('.prev-question-btn').forEach(button => {
        button.style.display = 'none';
      });
      
      toggleBibleText(false);
    }

    // 当进入测验部分时初始化
    document.querySelector('[data-next="quiz"]').addEventListener('click', function() {
      setTimeout(initQuiz, 100); // 给DOM更新一点时间
    });
    
    // Bible text font size controls
    const bibleContent = document.querySelector('.bible-content');
    let fontSize = 16; // Default font size
    
    document.getElementById('increase-font').addEventListener('click', function() {
      if (fontSize < 24) {
        fontSize += 2;
        bibleContent.style.fontSize = `${fontSize}px`;
      }
    });
    
    document.getElementById('decrease-font').addEventListener('click', function() {
      if (fontSize > 12) {
        fontSize -= 2;
        bibleContent.style.fontSize = `${fontSize}px`;
      }
    });
  });
</script>
</body>
</html>
