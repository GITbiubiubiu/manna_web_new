<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Genesis 8: The Flood Recedes - Manna</title>
  <meta name="description" content="Bible Lessons on Genesis 8 KJV: genesis 8 explained verse by verse.">
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="../css/lesson-content.css">
  <link rel="icon" href="../public/images/icon.png">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DF5ZGFNKTB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DF5ZGFNKTB');
  </script>
</head>

<body>
  <!-- Header -->
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <a href="/">
            <img src="../public/images/icon.png" alt="Manna Icon">
            <span>Manna</span>
          </a>
        </div>
        <nav>
          <ul>
            <li><a href="/bible-lessons">Lessons</a></li>
            <li><a href="/prayers">Prayers</a></li>
            <li><a href="/resources">Resources</a></li>
            <li><a href="/#download">Download</a></li>
          </ul>
        </nav>
        <div class="social-header">
          <a href="https://discord.gg/NbQVtWeNMa"><img src="../public/images/discard.png" alt="Discord"></a>
          <a href="https://www.instagram.com/the_manna_app"><img src="../public/images/ins.png" alt="Instagram"></a>
          <a href="https://www.tiktok.com/@manna.app"><img src="../public/images/tt.png" alt="TikTok"></a>
        </div>
      </div>
    </div>
  </header>

  <!-- Lesson Content -->
  <section class="lesson-content-section">
    <div class="container lesson-container">
      <!-- Left Side: Lesson Content -->
      <div class="lesson-content">
        <div class="lesson-progress">
          <div class="progress-bar">
            <div class="progress-fill" style="width: 0%"></div>
          </div>
          <div class="progress-text">0% Complete</div>
        </div>

        <!-- Section 1 -->
        <div class="lesson-section" id="section1">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>The Waters Recede</h2>
              <div class="lesson-reference" data-verses="1-5">Genesis 8:1-5</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "And God remembered Noah, and every living thing, and all the cattle that was with him in the ark: and God made a wind to pass over the earth, and the waters assuaged."
                  <cite>Genesis 8:1</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>God remembers Noah and causes the floodwaters to recede</li>
                  <li>The ark comes to rest on the mountains of Ararat</li>
                  <li>Gradually, the waters decrease, revealing the mountaintops</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>The first part of the chapter describes how the floodwaters begin to go down after many days. God remembers Noah and all the living creatures in the ark, showing His care for them. The ark eventually settles on a mountain, and over time, the water continues to decrease. This shows that even in difficult times, God is working behind the scenes to bring relief and restoration. The gradual process teaches patience and trust in God's timing.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="next-section-btn" data-next="section2">Continue</button>
          </div>
        </div>

        <!-- Section 2 -->
        <div class="lesson-section hidden" id="section2">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>Noah Sends a Raven and a Dove</h2>
              <div class="lesson-reference" data-verses="6-12">Genesis 8:6-12</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "Also he sent forth a dove from him, to see if the waters were abated from off the face of the ground."
                  <cite>Genesis 8:8</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>Noah sends a raven to check if the waters have subsided</li>
                  <li>A dove is sent later but returns, showing the land is still submerged</li>
                  <li>The dove eventually brings back an olive leaf, signaling new growth</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>Noah takes practical steps to see if the land is ready by sending out birds. The raven flies back and forth, but the dove's behavior gives clearer signs. When the dove returns with a fresh olive leaf, it is a hopeful sign that life is returning to the earth. This part highlights the importance of observing and responding to the signs of renewal around us. It also shows how small acts, like sending a dove, can bring big revelations.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section1">Previous</button>
            <button class="next-section-btn" data-next="section3">Continue</button>
          </div>
        </div>

        <!-- Section 3 -->
        <div class="lesson-section hidden" id="section3">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>The Earth Dries and Noah Leaves the Ark</h2>
              <div class="lesson-reference" data-verses="13-19">Genesis 8:13-19</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "Go forth of the ark, thou, and thy wife, and thy sons, and thy sons' wives with thee."
                  <cite>Genesis 8:16</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>The earth finally dries completely after many months</li>
                  <li>God commands Noah and his family to leave the ark with all the animals</li>
                  <li>All living creatures exit the ark to repopulate the earth</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>After waiting patiently, Noah sees that the ground is completely dry. God then tells him it is safe to leave the ark with his family and all the animals. This moment marks a new beginning for creation, as everything starts fresh. The story emphasizes obedience, as Noah follows God's instructions exactly. Stepping out of the ark symbolizes moving forward into a new chapter with faith.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section2">Previous</button>
            <button class="next-section-btn" data-next="section4">Continue</button>
          </div>
        </div>

        <!-- Section 4 -->
        <div class="lesson-section hidden" id="section4">
          <div class="lesson-card">
            <div class="lesson-card-header">
              <h2>Noah's Sacrifice and God's Promise</h2>
              <div class="lesson-reference" data-verses="20-22">Genesis 8:20-22</div>
            </div>
            <div class="lesson-card-body">
              <div class="key-verse">
                <blockquote>
                  "And the LORD smelled a sweet savour; and the LORD said in his heart, I will not again curse the ground any more for man's sake; for the imagination of man's heart is evil from his youth; neither will I again smite any more every thing living, as I have done."
                  <cite>Genesis 8:21</cite>
                </blockquote>
              </div>
              <div class="key-points">
                <h3>Key Points:</h3>
                <ul>
                  <li>Noah builds an altar and offers sacrifices to God</li>
                  <li>God promises never to curse the earth again because of humanity</li>
                  <li>The seasons and natural cycles are established as enduring patterns</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="lesson-detail">
            <p>Noah's first act after leaving the ark is to worship God by offering sacrifices. God is pleased and makes a promise never to destroy the earth in the same way again. He also establishes the reliability of nature's cycles, like planting and harvest, as a sign of His faithfulness. This closing section reassures us of God's mercy and His commitment to creation. It reminds us to respond to God's goodness with gratitude and worship.</p>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section3">Previous</button>
            <button class="next-section-btn" data-next="quiz">Test My Mastery</button>
          </div>
        </div>

        <!-- Quiz Section -->
        <div class="lesson-section hidden" id="quiz">
          <div class="lesson-card quiz-card">
            <div class="lesson-card-header">
              <h2>Level Up Test</h2>
              <div class="lesson-reference" data-verses="1-22">Genesis 8</div>
            </div>
            <div class="lesson-card-body">
              <div class="quiz-container">
                <div class="quiz-progress">
                  <span id="quiz-progress-text">Question 1 of 3</span>
                  <div class="quiz-progress-bar">
                    <div class="quiz-progress-fill" style="width: 33%"></div>
                  </div>
                </div>
                
                <form id="quiz-form">
                  <!-- Question 1 -->
                  <div class="quiz-question" id="question1">
                    <h3>1. What did the dove bring back to Noah that showed new life was growing?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q1a" name="q1" value="A">
                        <label for="q1a">A. A fish</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1b" name="q1" value="B">
                        <label for="q1b">B. An olive leaf</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1c" name="q1" value="C">
                        <label for="q1c">C. A piece of wood</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q1d" name="q1" value="D">
                        <label for="q1d">D. A feather</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 8:11</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="submit-question-btn" data-question="1" data-verses="11">Submit Answer</button>
                      </div>
                    </div>
                  </div>

                  <!-- Question 2 -->
                  <div class="quiz-question hidden" id="question2">
                    <h3>2. Where did the ark come to rest after the flood?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q2a" name="q2" value="A">
                        <label for="q2a">A. Mount Sinai</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2b" name="q2" value="B">
                        <label for="q2b">B. Mount Ararat</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2c" name="q2" value="C">
                        <label for="q2c">C. Mount Everest</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q2d" name="q2" value="D">
                        <label for="q2d">D. Mount Carmel</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 8:4</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="prev-question-btn" data-prev="1">Previous</button>
                        <button type="button" class="submit-question-btn" data-question="2" data-verses="4">Submit Answer</button>
                      </div>
                    </div>
                  </div>

                  <!-- Question 3 -->
                  <div class="quiz-question hidden" id="question3">
                    <h3>3. What was Noah's first action after leaving the ark?</h3>
                    <div class="quiz-options">
                      <div class="quiz-option">
                        <input type="radio" id="q3a" name="q3" value="A">
                        <label for="q3a">A. He planted a garden</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3b" name="q3" value="B">
                        <label for="q3b">B. He built an altar and offered sacrifices</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3c" name="q3" value="C">
                        <label for="q3c">C. He prayed silently</label>
                      </div>
                      <div class="quiz-option">
                        <input type="radio" id="q3d" name="q3" value="D">
                        <label for="q3d">D. He built a house</label>
                      </div>
                    </div>
                    <div class="quiz-hint hidden">
                      <p><strong>Hint:</strong> Genesis 8:20</p>
                    </div>
                    <div class="quiz-feedback hidden"></div>
                    <div class="quiz-controls">
                      <div class="quiz-buttons-center">
                        <button type="button" class="prev-question-btn" data-prev="2">Previous</button>
                        <button type="button" class="submit-question-btn" data-question="3" data-verses="20">Submit Answer</button>
                      </div>
                    </div>
                  </div>
                </form>

                <div id="quiz-results" class="hidden">
                  <h3>Your Results</h3>
                  <p id="quiz-score"></p>
                  <div id="quiz-feedback"></div>
                  <div class="quiz-result-buttons">
                    <button id="retry-quiz-btn">Try Again</button>
                    <button id="complete-lesson-btn">Complete Lesson</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="lesson-navigation-buttons">
            <button class="prev-section-btn" data-prev="section4">Previous</button>
          </div>
        </div>

        <!-- Completion Message (Hidden initially) -->
        <div class="lesson-completion hidden" id="completion">
          <div class="completion-card">
            <div class="completion-header">
              <div class="completion-icon">✓</div>
              <h2>Lesson Complete!</h2>
            </div>
            <div class="completion-content">
              <p class="completion-message">Congratulations on completing Genesis 8. You've learned about the end of the flood and God's promise to Noah.</p>
              
              <div class="app-promotion">
                <p class="app-promotion-text">Download the Manna App to unlock more free content.</p>
                <ul class="app-features-list">
                  <li>More audio courses, Prayer, and Devotional content for Free</li>
                  <li>Progress tracking, streak rewards, and grow closer to God</li>
                  <li>Get answers to any Bible-related questions</li>
                </ul>
                <div class="download-options">
                  <div class="qr-code">
                    <img src="../public/images/qrcode.png" alt="QR Code to download Manna App">
                  </div>
                  <div class="app-store-links">
                    <a href="https://apps.apple.com/us/app/manna-bible-study-prayer/id1669523799" class="app-store-link">
                      <img src="../public/images/download.png" alt="Download on App Store">
                    </a>
                  </div>
                </div>
              </div>
              
              <div class="completion-buttons">
                <a href="/bible-lessons/genesis9" class="lesson-btn primary-btn">Next Lesson: Genesis 9</a>
                <a href="/bible-lessons" class="lesson-btn secondary-btn">Back to Lessons</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Side: Bible Text -->
      <div class="bible-text">
        <div class="bible-header">
          <h2>Genesis 8</h2>
          <div class="bible-controls">
            <button id="increase-font">A+</button>
            <button id="decrease-font">A-</button>
          </div>
        </div>
        <div class="bible-content">
          <p><sup>1</sup> And God remembered Noah, and every living thing, and all the cattle that was with him in the ark: and God made a wind to pass over the earth, and the waters assuaged;</p>
          <p><sup>2</sup> The fountains also of the deep and the windows of heaven were stopped, and the rain from heaven was restrained;</p>
          <p><sup>3</sup> And the waters returned from off the earth continually: and after the end of the hundred and fifty days the waters were abated.</p>
          <p><sup>4</sup> And the ark rested in the seventh month, on the seventeenth day of the month, upon the mountains of Ararat.</p>
          <p><sup>5</sup> And the waters decreased continually until the tenth month: in the tenth month, on the first day of the month, were the tops of the mountains seen.</p>
          <p><sup>6</sup> And it came to pass at the end of forty days, that Noah opened the window of the ark which he had made:</p>
          <p><sup>7</sup> And he sent forth a raven, which went forth to and fro, until the waters were dried up from off the earth.</p>
          <p><sup>8</sup> Also he sent forth a dove from him, to see if the waters were abated from off the face of the ground;</p>
          <p><sup>9</sup> But the dove found no rest for the sole of her foot, and she returned unto him into the ark, for the waters were on the face of the whole earth: then he put forth his hand, and took her, and pulled her in unto him into the ark.</p>
          <p><sup>10</sup> And he stayed yet other seven days; and again he sent forth the dove out of the ark;</p>
          <p><sup>11</sup> And the dove came in to him in the evening; and, lo, in her mouth was an olive leaf pluckt off: so Noah knew that the waters were abated from off the earth.</p>
          <p><sup>12</sup> And he stayed yet other seven days; and sent forth the dove; which returned not again unto him any more.</p>
          <p><sup>13</sup> And it came to pass in the six hundredth and first year, in the first month, the first day  And it came to pass in the six hundredth and first year, in the first month, the first day of the month, the waters were dried up from off the earth: and Noah removed the covering of the ark, and looked, and, behold, the face of the ground was dry.</p>
          <p><sup>14</sup> And in the second month, on the seven and twentieth day of the month, was the earth dried.</p>
          <p><sup>15</sup> And God spake unto Noah, saying,</p>
          <p><sup>16</sup> Go forth of the ark, thou, and thy wife, and thy sons, and thy sons' wives with thee.</p>
          <p><sup>17</sup> Bring forth with thee every living thing that is with thee, of all flesh, both of fowl, and of cattle, and of every creeping thing that creepeth upon the earth; that they may breed abundantly in the earth, and be fruitful, and multiply upon the earth.</p>
          <p><sup>18</sup> And Noah went forth, and his sons, and his wife, and his sons' wives with him:</p>
          <p><sup>19</sup> Every beast, every creeping thing, and every fowl, and whatsoever creepeth upon the earth, after their kinds, went forth out of the ark.</p>
          <p><sup>20</sup> And Noah builded an altar unto the LORD; and took of every clean beast, and of every clean fowl, and offered burnt offerings on the altar.</p>
          <p><sup>21</sup> And the LORD smelled a sweet savour; and the LORD said in his heart, I will not again curse the ground any more for man's sake; for the imagination of man's heart is evil from his youth; neither will I again smite any more every thing living, as I have done.</p>
          <p><sup>22</sup> While the earth remaineth, seedtime and harvest, and cold and heat, and summer and winter, and day and night shall not cease.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-column">
          <h4>Links</h4>
          <div class="social-links">
            <a href="https://discord.gg/NbQVtWeNMa"><img src="../public/images/discard.png" alt="Discord"></a>
            <a href="https://www.instagram.com/the_manna_app"><img src="../public/images/ins.png" alt="Instagram"></a>
            <a href="https://www.tiktok.com/@manna.app"><img src="../public/images/tt.png" alt="TikTok"></a>
          </div>
        </div>
        <div class="footer-column">
          <h4>Contact Us</h4>
          <p><a href="mailto:support@themanna.app">support@themanna.app</a></p>
        </div>
        <div class="footer-column">
          <h4>Legal</h4>
          <div class="legal">
            <a href="https://s.femometer.com/html_template/3027.html">Privacy Policy</a>
            <a href="https://s.femometer.com/html_template/3028.html">Terms of Service</a>
          </div>
        </div>
      </div>
      <div class="copyright">
        <p>&copy; 2025 Baymed Limited. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Navigation between sections
      const sections = document.querySelectorAll('.lesson-section');
      const progressBar = document.querySelector('.progress-fill');
      const progressText = document.querySelector('.progress-text');
      const bibleVerses = document.querySelectorAll('.bible-content p');
      let currentSectionIndex = 0;
      const totalSections = sections.length - 1; // Excluding quiz section
      
      // 高亮并滚动到指定的经文
      function highlightVerses(verseRange) {
        // 移除之前的高亮
        bibleVerses.forEach(verse => {
          verse.classList.remove('highlighted');
        });
        
        if (verseRange) {
          const [start, end] = verseRange.split('-').map(v => parseInt(v));
          const endVerse = end || start;
          
          // 添加高亮到引用的经文
          for (let i = start - 1; i < endVerse; i++) {
            if (bibleVerses[i]) {
              bibleVerses[i].classList.add('highlighted');
              
              // 滚动到第一个高亮的经文
              if (i === start - 1) {
                bibleVerses[i].scrollIntoView({
                  behavior: 'smooth',
                  block: 'center'
                });
              }
            }
          }
        }
      }
      
      // Update progress
      function updateProgress() {
        if (currentSectionIndex < totalSections) {
          const progress = Math.round((currentSectionIndex / totalSections) * 100);
          progressBar.style.width = `${progress}%`;
          progressText.textContent = `${progress}% Complete`;
        }
      }
      
      // Show section
      function showSection(sectionId) {
        sections.forEach(section => {
          section.classList.add('hidden');
        });
        
        const currentSection = document.getElementById(sectionId);
        currentSection.classList.remove('hidden');
        
        // 更新当前部分索引
        for (let i = 0; i < sections.length; i++) {
          if (sections[i].id === sectionId) {
            currentSectionIndex = i;
            break;
          }
        }
        
        // 自动高亮相关经文
        const reference = currentSection.querySelector('.lesson-reference');
        if (reference) {
          const verseRange = reference.getAttribute('data-verses');
          highlightVerses(verseRange);
        }
        
        updateProgress();

        // 如果是测试模块，立即隐藏所有 Previous 按钮
        if (sectionId === 'quiz') {
          // 隐藏底部导航中的 Previous 按钮
          document.querySelector('#quiz .lesson-navigation-buttons .prev-section-btn').style.display = 'none';
          // 隐藏问题中的 Previous 按钮
          document.querySelectorAll('.prev-question-btn').forEach(button => {
            button.style.display = 'none';
          });
        }
        
        // 滚动到部分顶部
        window.scrollTo({
          top: document.querySelector('.lesson-content').offsetTop - 100,
          behavior: 'smooth'
        });
      }
      
      // Next section buttons
      document.querySelectorAll('.next-section-btn').forEach(button => {
        button.addEventListener('click', function() {
          const nextSectionId = this.getAttribute('data-next');
          showSection(nextSectionId);
        });
      });
      
      // Previous section buttons
      document.querySelectorAll('.prev-section-btn').forEach(button => {
        button.addEventListener('click', function() {
          const prevSectionId = this.getAttribute('data-prev');
          showSection(prevSectionId);
        });
      });
      
      // 初始化第一部分的经文高亮
      const initialReference = document.querySelector('#section1 .lesson-reference');
      if (initialReference) {
        const verseRange = initialReference.getAttribute('data-verses');
        highlightVerses(verseRange);
      }
      
      // Quiz functionality
      const quizForm = document.getElementById('quiz-form');
      const quizQuestions = document.querySelectorAll('.quiz-question');
      const quizResults = document.getElementById('quiz-results');
      const quizScore = document.getElementById('quiz-score');
      const quizFeedback = document.getElementById('quiz-feedback');
      const retryQuizBtn = document.getElementById('retry-quiz-btn');
      const completeLessonBtn = document.getElementById('complete-lesson-btn');
      const quizProgressText = document.getElementById('quiz-progress-text');
      const quizProgressFill = document.querySelector('.quiz-progress-fill');
      const bibleTextSection = document.querySelector('.bible-text');
      let currentQuestionIndex = 0;
      let userAnswers = {};
      let questionSubmitted = {};

      // 初始化时隐藏圣经文本
      function toggleBibleText(show) {
        if (show) {
          bibleTextSection.style.display = 'block';
        } else {
          bibleTextSection.style.display = 'none';
        }
      }

      // 显示指定问题
      function showQuestion(index) {
        quizQuestions.forEach((question, i) => {
          if (i === index) {
            question.classList.remove('hidden');
          } else {
            question.classList.add('hidden');
          }
        });
        
        // 更新进度条
        currentQuestionIndex = index;
        quizProgressText.textContent = `Question ${index + 1} of ${quizQuestions.length}`;
        quizProgressFill.style.width = `${((index + 1) / quizQuestions.length) * 100}%`;
        
        // 如果问题已提交，显示圣经文本，否则隐藏
        toggleBibleText(questionSubmitted[index + 1]);
      }

      // 提交问题答案
      function submitQuestion(questionNumber, verseRange) {
        const questionIndex = questionNumber - 1;
        const selectedOption = document.querySelector(`input[name="q${questionNumber}"]:checked`);
        const feedbackElement = document.querySelector(`#question${questionNumber} .quiz-feedback`);
        const hintElement = document.querySelector(`#question${questionNumber} .quiz-hint`);
        const submitButton = document.querySelector(`#question${questionNumber} .submit-question-btn`);
        const nextButton = document.createElement('button');
        nextButton.type = 'button';
        nextButton.className = 'next-question-btn';
        
        const answers = {
          q1: 'B',
          q2: 'B',
          q3: 'B'
        };
        
        if (!selectedOption) {
          feedbackElement.innerHTML = '<p class="incorrect">Please select an answer.</p>';
          feedbackElement.classList.remove('hidden');
          return;
        }
        
        // 记录用户答案
        userAnswers[`q${questionNumber}`] = selectedOption.value;
        questionSubmitted[questionNumber] = true;
        
        // 显示提示和反馈
        hintElement.classList.remove('hidden');
        
        // 禁用选项和提交按钮
        document.querySelectorAll(`#question${questionNumber} input[type="radio"]`).forEach(input => {
          input.disabled = true;
        });
        submitButton.disabled = true;
        submitButton.style.display = 'none'; // 隐藏提交按钮
        
        // 显示反馈
        if (selectedOption.value === answers[`q${questionNumber}`]) {
          feedbackElement.innerHTML = '<p class="correct">Correct!</p>';
        } else {
          feedbackElement.innerHTML = `<p class="incorrect">Incorrect. The correct answer is ${answers[`q${questionNumber}`]}.</p>`;
        }
        feedbackElement.classList.remove('hidden');
        
        // 显示圣经文本并高亮相关经文
        toggleBibleText(true);
        highlightVerses(verseRange);
        
        // 如果不是最后一个问题，添加下一题按钮
        if (questionNumber < quizQuestions.length) {
          nextButton.textContent = 'Next Question';
          nextButton.setAttribute('data-next', questionNumber + 1);
          nextButton.addEventListener('click', function() {
            showQuestion(parseInt(this.getAttribute('data-next')) - 1);
          });
          submitButton.parentNode.appendChild(nextButton);
        } else {
          // 如果是最后一个问题，添加查看结果按钮
          nextButton.textContent = 'View Results';
          nextButton.addEventListener('click', showResults);
          submitButton.parentNode.appendChild(nextButton);
        }
      }

      // 显示测验结果
      function showResults() {
        const answers = {
          q1: 'B',
          q2: 'B',
          q3: 'B'
        };
        
        let score = 0;
        let feedback = '';
        
        // 检查答案
        for (const question in answers) {
          if (userAnswers[question] === answers[question]) {
            score++;
            feedback += `<p class="correct">Question ${question.substring(1)}: Correct!</p>`;
          } else {
            feedback += `<p class="incorrect">Question ${question.substring(1)}: Incorrect. The correct answer is ${answers[question]}.</p>`;
          }
        }
        
        // 显示结果
        quizScore.textContent = `You scored ${score} out of 3`;
        quizFeedback.innerHTML = feedback;
        
        // 隐藏问题，显示结果
        quizQuestions.forEach(question => {
          question.classList.add('hidden');
        });
        quizResults.classList.remove('hidden');
      }

      // 重置测验
      retryQuizBtn.addEventListener('click', function() {
        quizForm.reset();
        quizResults.classList.add('hidden');
        userAnswers = {};
        questionSubmitted = {};
        
        // 重置所有问题状态
        document.querySelectorAll('.quiz-hint').forEach(element => {
          element.classList.add('hidden');
        });
        
        document.querySelectorAll('.quiz-feedback').forEach(element => {
          element.classList.add('hidden');
          element.innerHTML = ''; // 清空反馈内容
        });
        
        document.querySelectorAll('.quiz-question input[type="radio"]').forEach(input => {
          input.disabled = false;
        });
        
        document.querySelectorAll('.submit-question-btn').forEach(button => {
          button.disabled = false;
          button.style.display = '';
        });
        
        document.querySelectorAll('.next-question-btn').forEach(button => {
          button.remove();
        });
        
        // 显示第一个问题
        showQuestion(0);
        toggleBibleText(false);
      });

      // 完成课程
      completeLessonBtn.addEventListener('click', function() {
        document.getElementById('quiz').classList.add('hidden');
        document.getElementById('completion').classList.remove('hidden');
        progressBar.style.width = '100%';
        progressText.textContent = '100% Complete';
        // 隐藏圣经文本
        toggleBibleText(false);
      });

      // 上一题按钮
      document.querySelectorAll('.prev-question-btn').forEach(button => {
        button.addEventListener('click', function() {
          const prevQuestionIndex = parseInt(this.getAttribute('data-prev')) - 1;
          showQuestion(prevQuestionIndex);
        });
      });

      // 提交答案按钮
      document.querySelectorAll('.submit-question-btn').forEach(button => {
        button.addEventListener('click', function() {
          const questionNumber = parseInt(this.getAttribute('data-question'));
          const verseRange = this.getAttribute('data-verses');
          submitQuestion(questionNumber, verseRange);
        });
      });

      // 初始化测验
      function initQuiz() {
        // 确保只显示第一个问题，其他都隐藏
        quizQuestions.forEach((question, i) => {
          if (i === 0) {
            question.classList.remove('hidden');
          } else {
            question.classList.add('hidden');
          }
        });
        
        // 隐藏所有提示
        document.querySelectorAll('.quiz-hint').forEach(hint => {
          hint.classList.add('hidden');
        });
        
        // 隐藏结果部分
        document.getElementById('quiz-results').classList.add('hidden');
        
        // 隐藏底部导航中的 Previous 按钮
        document.querySelector('#quiz .lesson-navigation-buttons .prev-section-btn').style.display = 'none';
        
        // 隐藏所有问题中的 Previous 按钮
        document.querySelectorAll('.prev-question-btn').forEach(button => {
          button.style.display = 'none';
        });
        
        toggleBibleText(false);
      }

      // 当进入测验部分时初始化
      document.querySelector('[data-next="quiz"]').addEventListener('click', function() {
        setTimeout(initQuiz, 100); // 给DOM更新一点时间
      });
      
      // Bible text font size controls
      const bibleContent = document.querySelector('.bible-content');
      let fontSize = 16; // Default font size
      
      document.getElementById('increase-font').addEventListener('click', function() {
        if (fontSize < 24) {
          fontSize += 2;
          bibleContent.style.fontSize = `${fontSize}px`;
        }
      });
      
      document.getElementById('decrease-font').addEventListener('click', function() {
        if (fontSize > 12) {
          fontSize -= 2;
          bibleContent.style.fontSize = `${fontSize}px`;
        }
      });
    });
  </script>
</body>
</html>
